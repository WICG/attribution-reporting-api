<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Attribution Reporting</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in Â§N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	html {
		color: black;
		color: var(--text);
		background-color: white;
		background-color: var(--bg);
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		background: transparent top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	 border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd;
	  border: thin solid var(--algo-border);
	  border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: red;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #080;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: none;
		border-bottom: 1px solid #707070;
		border-bottom: 1px solid var(--a-normal-underline);
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		border-bottom-color: #bbb;
		border-bottom-color: var(--a-visited-underline);
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		border-color: #c00;
		border-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker {
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

	@media not print {
		details.annoying-warning[open] {
			position: fixed;
			left: 0;
			right: 0;
			bottom: 2em;
			z-index: 1000;
		}
	}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom: 3px solid #054572;
			border-bottom: 3px solid var(--toclink-underline);
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span:not(.dfn-paneled) {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good table positioning:
		   "content column" is 50ems wide at max; less on smaller screens.
		   Extra space (after ToC + content) is empty on the right.

		   1. When table < content column, centers table in column.
		   2. When content < table < available, left-aligns.
		   3. When table > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <link href="https://www.w3.org/StyleSheets/TR/2016/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 89ebb6ab, updated Fri Oct 9 15:32:07 2020 -0700" name="generator">
  <link href="https://wicg.github.io/conversion-measurement-api" rel="canonical">
  <meta content="bbb8567a8c9a874c7eb94e85f54ce07708f33adb" name="document-revision">
<style>/* darkmode */

            @media (prefers-color-scheme: dark) {
                html { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E") !important; }
            }
            </style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "â";
}
.css::after, .property::after, .descriptor::after {
    content: "â";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "â";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "â";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
html {
    color: black;
    color: var(--text);
    background-color: white;
    background-color: var(--bg);
}
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #707070;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #bbb;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "Â¶"; }
.heading > a.self-link::before { content: "Â§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: #fdf6e3; }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Attribution Reporting</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="2022-03-11">11 March 2022</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/conversion-measurement-api">https://wicg.github.io/conversion-measurement-api</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/conversion-measurement-api/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:csharrison@chromium.org">Charlie Harrison</a> (<a class="p-org org" href="https://google.com">Google Inc.</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:johnidel@chromium.org">John Delaney</a> (<a class="p-org org" href="https://google.com">Google Inc.</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:apaseltiner@chromium.org">Andrew Paseltiner</a> (<a class="p-org org" href="https://google.com">Google Inc.</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> Â© 2022 the Contributors to the Attribution Reporting Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>An API to report that an event may have been caused by another cross-site event. These reports are designed to transfer little enough data between sites that the sites canât use them to track individual users.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#overview"><span class="secno">1.1</span> <span class="content">Overview</span></a>
     </ol>
    <li>
     <a href="#html-monkeypatches"><span class="secno">2</span> <span class="content">HTML monkeypatches</span></a>
     <ol class="toc">
      <li><a href="#longlong-reflection"><span class="secno">2.1</span> <span class="content"> long long reflection </span></a>
      <li><a href="#monkeypatch-anchor"><span class="secno">2.2</span> <span class="content">&lt;a> element</span></a>
      <li>
       <a href="#monkeypatch-navigation"><span class="secno">2.3</span> <span class="content">Navigation</span></a>
       <ol class="toc">
        <li><a href="#monkeypatch-navigation-params"><span class="secno">2.3.1</span> <span class="content">Navigation Params</span></a>
        <li><a href="#monkeypatch-navigate-algorithm"><span class="secno">2.3.2</span> <span class="content">Navigate algorithm</span></a>
        <li><a href="#monkeypatch-navigate-fetch"><span class="secno">2.3.3</span> <span class="content">Process a navigate fetch</span></a>
        <li><a href="#monkeypatch-document-creation"><span class="secno">2.3.4</span> <span class="content">Document creation</span></a>
       </ol>
      <li><a href="#monkeypatch-following-hyperlink"><span class="secno">2.4</span> <span class="content">Follow the hyperlink</span></a>
     </ol>
    <li><a href="#fetch-monkeypatches"><span class="secno">3</span> <span class="content">Fetch monkeypatches</span></a>
    <li><a href="#attribution-reporting-api"><span class="secno">4</span> <span class="content">Attribution Reporting API</span></a>
    <li><a href="#permission-policy-integration"><span class="secno">5</span> <span class="content">Permissions Policy integration</span></a>
    <li>
     <a href="#structures"><span class="secno">6</span> <span class="content">Structures</span></a>
     <ol class="toc">
      <li><a href="#attribution-mode"><span class="secno">6.1</span> <span class="content">Attribution mode</span></a>
      <li><a href="#attribution-source"><span class="secno">6.2</span> <span class="content">Attribution source</span></a>
      <li><a href="#attribution-trigger"><span class="secno">6.3</span> <span class="content">Attribution trigger</span></a>
      <li><a href="#attribution-report"><span class="secno">6.4</span> <span class="content">Attribution report</span></a>
      <li><a href="#attribution-rate-limit-record"><span class="secno">6.5</span> <span class="content">Attribution rate-limit record</span></a>
     </ol>
    <li><a href="#storage"><span class="secno">7</span> <span class="content">Storage</span></a>
    <li>
     <a href="#general-algorithms"><span class="secno">8</span> <span class="content">General Algorithms</span></a>
     <ol class="toc">
      <li><a href="#obtaining-randomized-response"><span class="secno">8.1</span> <span class="content">Obtaining a randomized response</span></a>
     </ol>
    <li>
     <a href="#source-algorithms"><span class="secno">9</span> <span class="content">Source Algorithms</span></a>
     <ol class="toc">
      <li><a href="#obtaining-attribution-source-expiry-time"><span class="secno">9.1</span> <span class="content">Obtaining an attribution sourceâs expiry time</span></a>
      <li><a href="#parsing-data-fields"><span class="secno">9.2</span> <span class="content">Parsing data fields</span></a>
      <li><a href="#parsing-attribution-destination"><span class="secno">9.3</span> <span class="content">Parsing an attribution destination</span></a>
      <li><a href="#obtaining-random-attribution-mode"><span class="secno">9.4</span> <span class="content">Obtaining a random attribution mode</span></a>
      <li><a href="#obtaining-attribution-source-anchor"><span class="secno">9.5</span> <span class="content">Obtaining an attribution source from an <code>a</code> element</span></a>
      <li><a href="#obtaining-event-attribution-source-anchor"><span class="secno">9.6</span> <span class="content">Obtaining an event attribution source from an <code>a</code> element</span></a>
      <li><a href="#obtaining-event-attribution-source-source"><span class="secno">9.7</span> <span class="content">Obtaining an event attribution source from a source</span></a>
      <li><a href="#obtaining-attribution-source-params"><span class="secno">9.8</span> <span class="content">Obtaining an attribution source from <code class="idl"><span>AttributionSourceParams</span></code></span></a>
      <li><a href="#processing-an-attribution-source"><span class="secno">9.9</span> <span class="content">Processing an attribution source</span></a>
     </ol>
    <li>
     <a href="#trigger-algorithms"><span class="secno">10</span> <span class="content">Triggering Algorithms</span></a>
     <ol class="toc">
      <li><a href="#attribution-trigger-creation"><span class="secno">10.1</span> <span class="content">Creating an attribution trigger</span></a>
      <li><a href="#should-block-response"><span class="secno">10.2</span> <span class="content">Should internalResponse to request be blocked as attribution trigger</span></a>
      <li><a href="#should-rate-limit-attribution"><span class="secno">10.3</span> <span class="content">Should attribution be blocked by rate limit</span></a>
      <li><a href="#triggering-attribution"><span class="secno">10.4</span> <span class="content">Triggering attribution</span></a>
      <li><a href="#delivery-time"><span class="secno">10.5</span> <span class="content">Establishing report delivery time</span></a>
      <li><a href="#obtaining-a-report"><span class="secno">10.6</span> <span class="content">Obtaining a report</span></a>
     </ol>
    <li>
     <a href="#report-delivery"><span class="secno">11</span> <span class="content">Report delivery</span></a>
     <ol class="toc">
      <li><a href="#serialize-integer"><span class="secno">11.1</span> <span class="content">Serialize an integer</span></a>
      <li><a href="#serialize-report-body"><span class="secno">11.2</span> <span class="content">Serialize attribution report body</span></a>
      <li><a href="#get-report-url"><span class="secno">11.3</span> <span class="content">Get report request URL</span></a>
      <li><a href="#issue-report-request"><span class="secno">11.4</span> <span class="content">Issuing a report request</span></a>
     </ol>
    <li><a href="#security-considerations"><span class="secno">12</span> <span class="content">Security considerations</span></a>
    <li>
     <a href="#privacy-considerations"><span class="secno">13</span> <span class="content">Privacy consideration</span></a>
     <ol class="toc">
      <li><a href="#clearing-attribution-storage"><span class="secno">13.1</span> <span class="content">Clearing attribution storage</span></a>
     </ol>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is non-normative</em></p>
   <p>This specification describes how web browsers can provide a mechanism to the
web that supports measuring and attributing conversions (e.g. purchases) to ads
a user interacted with on another site. This mechanism should remove one need
for cross-site identifiers like third-party cookies.</p>
   <h3 class="heading settled" data-level="1.1" id="overview"><span class="secno">1.1. </span><span class="content">Overview</span><a class="self-link" href="#overview"></a></h3>
   <p>A page can register an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-source">attribution source</a> on a site by providing <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionsourceeventid" id="ref-for-element-attrdef-a-attributionsourceeventid">attributionsourceeventid</a></code> and <code><a data-link-type="element-sub" href="#element-attrdef-a-attributiondestination" id="ref-for-element-attrdef-a-attributiondestination">attributiondestination</a></code> attributes on an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element">a</a></code> element.
When such an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ ">a</a></code> element is clicked, and the resulting navigation commits in a document within the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-site" id="ref-for-same-site">same site</a> as
the <code><a data-link-type="element-sub" href="#element-attrdef-a-attributiondestination" id="ref-for-element-attrdef-a-attributiondestinationâ ">attributiondestination</a></code>, the <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ ">attribution source</a> is stored in UA storage.</p>
   <p>Alternatively, a page can register an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¡">attribution source</a> on a site by providing a <code><a data-link-type="element-sub" href="#element-attrdef-a-registerattributionsource" id="ref-for-element-attrdef-a-registerattributionsource">registerattributionsource</a></code> attribute on an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ¡">a</a></code> element. When such an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ¢">a</a></code> element is added
to the page, the <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¢">attribution source</a> is stored in UA storage.</p>
   <p>At a later point, the <code><a data-link-type="element-sub" href="#element-attrdef-a-attributiondestination" id="ref-for-element-attrdef-a-attributiondestinationâ¡">attributiondestination</a></code> site may fire an HTTP request to
trigger attribution, which matches an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-trigger">attribution trigger</a> with any previously
stored sources. If a matching source exists, it is scheduled to be
reported at a later time, possibly multiple days in the future.</p>
   <p>Reports are sent to reporting endpoints that are configured in the attribution source
and attribution trigger.</p>
   <h2 class="heading settled" data-level="2" id="html-monkeypatches"><span class="secno">2. </span><span class="content">HTML monkeypatches</span><a class="self-link" href="#html-monkeypatches"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="longlong-reflection"><span class="secno">2.1. </span><span class="content"> long long reflection </span><a class="self-link" href="#longlong-reflection"></a></h3>
   <p>Add the following rules for <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect" id="ref-for-reflect">reflecting</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributes">content attributes</a>:</p>
   <p>If a reflecting IDL attribute has a signed integer type (<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-long">long long</a></code>) then, on getting, the content attribute must be
parsed according to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers" id="ref-for-rules-for-parsing-integers">rules for parsing integers</a>, and if that is successful, and the value is in the
range of the IDL attributeâs type, the resulting value must be returned. If, on the other hand, it fails or returns
an out of range value, or if the attribute is absent, then the default value must be returned instead, or 0 if there
is no default value. On setting, the given value must be converted to the shortest possible string representing the
number as a valid integer and then that string must be used as the new content attribute value.</p>
   <p>If a reflecting IDL attribute has a signed integer type (<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-longâ ">long long</a></code>) that is <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="limited-to-only-non-negative-numbers">limited to only non-negative numbers</dfn> then,
on getting, the content attribute must be parsed according to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</a>, and if
that is successful, and the value is in the range of the IDL attributeâs type, the resulting value must be returned.
If, on the other hand, it fails or returns an out of range value, or if the attribute is absent, the default value
must be returned instead, or â1 if there is no default value. On setting, if the value is negative, the user agent
must throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#indexsizeerror" id="ref-for-indexsizeerror">"IndexSizeError"</a></code> <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>. Otherwise, the given value must be converted to the shortest possible
string representing the number as a valid non-negative integer and then that string must be used as the new content
attribute value.</p>
   <h3 class="heading settled" data-level="2.2" id="monkeypatch-anchor"><span class="secno">2.2. </span><span class="content">&lt;a> element</span><a class="self-link" href="#monkeypatch-anchor"></a></h3>
   <p>Add the following <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributesâ ">content attributes</a> to the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ£">a</a></code> element:</p>
   <dl>
    <dt data-md><code><a data-link-type="element-sub" href="#element-attrdef-a-attributionsourceeventid" id="ref-for-element-attrdef-a-attributionsourceeventidâ ">attributionsourceeventid</a></code>
    <dd data-md>
     <p>Identifies the declared attribution source</p>
    <dt data-md><code><a data-link-type="element-sub" href="#element-attrdef-a-attributiondestination" id="ref-for-element-attrdef-a-attributiondestinationâ¢">attributiondestination</a></code>
    <dd data-md>
     <p>Site which can attribute an event to the declared attribution source</p>
    <dt data-md><code><a data-link-type="element-sub" href="#element-attrdef-a-attributionreportto" id="ref-for-element-attrdef-a-attributionreportto">attributionreportto</a></code>
    <dd data-md>
     <p><a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a> to receive attribution reports</p>
    <dt data-md><code><a data-link-type="element-sub" href="#element-attrdef-a-attributionexpiry" id="ref-for-element-attrdef-a-attributionexpiry">attributionexpiry</a></code>
    <dd data-md>
     <p>Length of time the attribution souce is valid</p>
    <dt data-md><code><a data-link-type="element-sub" href="#element-attrdef-a-attributionsourcepriority" id="ref-for-element-attrdef-a-attributionsourcepriority">attributionsourcepriority</a></code>
    <dd data-md>
     <p>The priority of this source relative to other sources when triggering attribution</p>
    <dt data-md><code><a data-link-type="element-sub" href="#element-attrdef-a-registerattributionsource" id="ref-for-element-attrdef-a-registerattributionsourceâ ">registerattributionsource</a></code>
    <dd data-md>
     <p>Registers an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ£">attribution source</a> with a source type "<code>event</code>"</p>
   </dl>
   <p>Extend the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ¤">a</a></code> elementâs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-dom" id="ref-for-concept-element-dom">DOM interface</a> to include the following interface:</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement" id="ref-for-htmlanchorelement"><c- g>HTMLAnchorElement</c-></a> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLAnchorElement" data-dfn-type="attribute" data-export data-type="USVString" id="dom-htmlanchorelement-attributiondestination"><code><c- g>attributionDestination</c-></code></dfn>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactionsâ "><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLAnchorElement" data-dfn-type="attribute" data-export data-type="DOMString" id="dom-htmlanchorelement-attributionsourceeventid"><code><c- g>attributionSourceEventId</c-></code></dfn>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactionsâ¡"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVStringâ "><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLAnchorElement" data-dfn-type="attribute" data-export data-type="USVString" id="dom-htmlanchorelement-attributionreportto"><code><c- g>attributionReportTo</c-></code></dfn>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactionsâ¢"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-longâ¡"><c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLAnchorElement" data-dfn-type="attribute" data-export data-type="long long" id="dom-htmlanchorelement-attributionexpiry"><code><c- g>attributionExpiry</c-></code></dfn>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactionsâ£"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-longâ¢"><c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLAnchorElement" data-dfn-type="attribute" data-export data-type="long long" id="dom-htmlanchorelement-attributionsourcepriority"><code><c- g>attributionSourcePriority</c-></code></dfn>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactionsâ¤"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLAnchorElement" data-dfn-type="attribute" data-export data-type="boolean" id="dom-htmlanchorelement-registerattributionsource"><code><c- g>registerAttributionSource</c-></code></dfn>;
};
</pre>
   <p>The IDL attributes <code class="idl"><a data-link-type="idl" href="#dom-htmlanchorelement-attributiondestination" id="ref-for-dom-htmlanchorelement-attributiondestination">attributionDestination</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-htmlanchorelement-attributionsourceeventid" id="ref-for-dom-htmlanchorelement-attributionsourceeventid">attributionSourceEventId</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-htmlanchorelement-attributionreportto" id="ref-for-dom-htmlanchorelement-attributionreportto">attributionReportTo</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-htmlanchorelement-attributionsourcepriority" id="ref-for-dom-htmlanchorelement-attributionsourcepriority">attributionSourcePriority</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-htmlanchorelement-registerattributionsource" id="ref-for-dom-htmlanchorelement-registerattributionsource">registerAttributionSource</a></code> must <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect" id="ref-for-reflectâ ">reflect</a> the respective
content attributes of the same name.</p>
   <p>The IDL attribute <code class="idl"><a data-link-type="idl" href="#dom-htmlanchorelement-attributionexpiry" id="ref-for-dom-htmlanchorelement-attributionexpiry">attributionExpiry</a></code> must reflect the <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionexpiry" id="ref-for-element-attrdef-a-attributionexpiryâ ">attributionexpiry</a></code> content attribute, <a data-link-type="dfn" href="#limited-to-only-non-negative-numbers" id="ref-for-limited-to-only-non-negative-numbers">limited to only non-negative numbers</a>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-for="a" data-dfn-type="element-attr" data-export id="element-attrdef-a-attributiondestination"><code>attributiondestination</code></dfn> attribute is a string
representing an <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ ">origin</a> that is intended to be <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-site" id="ref-for-same-siteâ ">same site</a> with the origin
of the final navigation URL resulting from running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2" id="ref-for-following-hyperlinks-2">follow the hyperlink</a> with the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ¥">a</a></code> element.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-for="a" data-dfn-type="element-attr" data-export id="element-attrdef-a-attributionsourceeventid"><code>attributionsourceeventid</code></dfn> attribute is a string
containing information about the <code>attribution source</code> and will be supplied in the <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-report">attribution report</a>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-for="a" data-dfn-type="element-attr" data-export id="element-attrdef-a-attributionreportto"><code>attributionreportto</code></dfn> attribute optionally declares the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin">origin</a> to send the <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ ">attribution report</a> for this source.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-for="a" data-dfn-type="element-attr" data-export id="element-attrdef-a-attributionexpiry"><code>attributionexpiry</code></dfn> attribute optionally defines the amount
of time in milliseconds the attribution source should be considered for reporting.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-for="a" data-dfn-type="element-attr" data-export id="element-attrdef-a-attributionsourcepriority"><code>attributionsourcepriority</code></dfn> attribute optionally defines the
priority of a source relative to other sources when triggering attribution. If not specified, 0 is used as the
priority. An <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-triggerâ ">attribution trigger</a> with a given <a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpoint">reporting endpoint</a> and <a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destination">attribution destination</a> will always be attributed to the source with the highest priority value that has the same <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpoint">reporting endpoint</a> and <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destination">attribution destination</a>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-for="a" data-dfn-type="element-attr" data-export id="element-attrdef-a-registerattributionsource"><code>registerattributionsource</code></dfn> attribute, if present, registers an
additional source whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-type">source type</a> is "<code>event</code>".</p>
   <p class="note" role="note"><span>Note:</span> One simple priority scheme would be to use the current millisecond timestamp as the priority value.</p>
   <h3 class="heading settled" data-level="2.3" id="monkeypatch-navigation"><span class="secno">2.3. </span><span class="content">Navigation</span><a class="self-link" href="#monkeypatch-navigation"></a></h3>
   <p>This section ensures that an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¤">attribution source</a> associated with a navigation
results in a top-level navigation whose final URL is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-site" id="ref-for-same-siteâ¡">same site</a> with the <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ ">attribution destination</a>.</p>
   <h4 class="heading settled" data-level="2.3.1" id="monkeypatch-navigation-params"><span class="secno">2.3.1. </span><span class="content">Navigation Params</span><a class="self-link" href="#monkeypatch-navigation-params"></a></h4>
   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params" id="ref-for-navigation-params">navigation params</a> struct has an item:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="navigation params" data-dfn-type="dfn" data-noexport id="navigation-params-attribution-source">attribution source</dfn>
    <dd data-md>
     <p>null or an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¥">attribution source</a> declared when initiating a navigation</p>
   </dl>
   <h4 class="heading settled" data-level="2.3.2" id="monkeypatch-navigate-algorithm"><span class="secno">2.3.2. </span><span class="content">Navigate algorithm</span><a class="self-link" href="#monkeypatch-navigate-algorithm"></a></h4>
   <p>Modify the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate">navigate</a> algorithm to accept a new optional parameter <var>attributionSource</var> of type <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¦">attribution source</a> defaulting to null.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigateâ ">navigate</a>, within step</p>
   <blockquote>
    <ol start="19">
     <li data-md>
      <p>This is the step that attempts to obtain resource, if necessary. Jump to the first appropriate substep:
...</p>
    </ol>
   </blockquote>
   <p>in the case where</p>
   <blockquote>
    <p>If resource is a response</p>
   </blockquote>
   <p>modify the substep</p>
   <blockquote>
    <ol start="7">
     <li data-md>
      <p>Let navigationParams be a new navigation params whose request is null, response is resource
...</p>
    </ol>
   </blockquote>
   <p>to set the <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-source">attribution source</a> of <var>navigationParams</var> to <var>attributionSource</var>.</p>
   <p>In the case where</p>
   <blockquote>
    <p>If resource is a request whose URLâs scheme is "javascript"</p>
   </blockquote>
   <p>modify the substep</p>
   <blockquote>
    <ol start="4">
     <li data-md>
      <p>Let navigationParams be a new navigation params whose request is resource,
...</p>
    </ol>
   </blockquote>
   <p>to set the <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-sourceâ ">attribution source</a> of <var>navigationParams</var> to <var>attributionSource</var>.</p>
   <p>In the case where</p>
   <blockquote>
    <p>If resource is a request whose URLâs scheme is a fetch scheme</p>
   </blockquote>
   <p>modify the substep to pass <var>attributionSource</var> to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetch">process a navigate fetch</a> algorithm.</p>
   <p class="note" role="note"><span>Note:</span> The final case, where the request is not a javascript or fetch scheme, does not need to be handled
 as it will not result in the navigation of a top-level browsing context.</p>
   <h4 class="heading settled" data-level="2.3.3" id="monkeypatch-navigate-fetch"><span class="secno">2.3.3. </span><span class="content">Process a navigate fetch</span><a class="self-link" href="#monkeypatch-navigate-fetch"></a></h4>
   <p>Modify the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetchâ ">process a navigate fetch</a> algorithm to accept a new optional parameter <var>attributionSource</var> of type <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ§">attribution source</a> defaulting to null.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetchâ¡">process a navigate fetch</a>, modify the step</p>
   <blockquote>
    <ol start="15">
     <li data-md>
      <p>Otherwise, if locationURL is a URL whose scheme is a fetch scheme, then run process a navigate fetch with a new request
...</p>
    </ol>
   </blockquote>
   <p>to also pass <var>attributionSource</var> into the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetchâ¢">process a navigate fetch</a> algorithm.</p>
   <p>Modify the step</p>
   <blockquote>
    <ol start="19">
     <li data-md>
      <p>Let navigationParams be a new navigation params whose request is request, response is response,
...</p>
    </ol>
   </blockquote>
   <p>to set the <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-sourceâ¡">attribution source</a> of <var>navigationParams</var> to <var>attributionSource</var>.</p>
   <h4 class="heading settled" data-level="2.3.4" id="monkeypatch-document-creation"><span class="secno">2.3.4. </span><span class="content">Document creation</span><a class="self-link" href="#monkeypatch-document-creation"></a></h4>
   <p>At the time <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object" id="ref-for-initialise-the-document-object">create and initialize a <code>Document</code> object</a> is invoked, the user agent knows the final URL used for the
navigation and can validate the <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ¡">attribution destination</a>.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object" id="ref-for-initialise-the-document-objectâ ">create and initialize a <code>Document</code> object</a>, before</p>
   <blockquote>
    <ol start="2">
     <li data-md>
      <p>Let permissionsPolicy be the result of creating a permissions policy from a response given browsingContext
...</p>
    </ol>
   </blockquote>
   <p>add the following step:</p>
   <ol>
    <li data-md>
     <p>Execute <a data-link-type="dfn" href="#maybe-process-a-navigation-attribution-source" id="ref-for-maybe-process-a-navigation-attribution-source">maybe process a navigation attribution source</a> with <var>navigationParams</var> and <var>browsingContext</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="2.4" id="monkeypatch-following-hyperlink"><span class="secno">2.4. </span><span class="content">Follow the hyperlink</span><a class="self-link" href="#monkeypatch-following-hyperlink"></a></h3>
   <p>Attribution source information declared on the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ¦">a</a></code> element needs to be passed to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigateâ¡">navigate</a> algorithm.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2" id="ref-for-following-hyperlinks-2â ">follow the hyperlink</a> after</p>
   <blockquote>
    <ol start="14">
     <li data-md>
      <p>Let historyHandling be "replace" if windowType is not "existing or none"; otherwise, "default".</p>
    </ol>
   </blockquote>
   <p>add the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>attributionSource</var> be null.</p>
    <li data-md>
     <p>If <var>subject</var> is an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ§">a</a></code> element, set <var>attributionSource</var> to the result of running <a data-link-type="dfn" href="#obtain-an-attribution-source-from-an-anchor" id="ref-for-obtain-an-attribution-source-from-an-anchor">obtain an attribution source from an anchor</a> with <var>subject</var>.</p>
   </ol>
   <p>Modify the step:</p>
   <blockquote>
    <ol start="15">
     <li data-md>
      <p>Queue an element task on the DOM manipulation task source given subject to navigate target to request
...</p>
    </ol>
   </blockquote>
   <p>to call <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigateâ¢">navigate</a> with <var>attributionSource</var> set to <var>attributionSource</var>.</p>
   <h2 class="heading settled" data-level="3" id="fetch-monkeypatches"><span class="secno">3. </span><span class="content">Fetch monkeypatches</span><a class="self-link" href="#fetch-monkeypatches"></a></h2>
   <p>In <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-main-fetch" id="ref-for-concept-main-fetch">main fetch</a>, within the step:</p>
   <blockquote>
    <ol start="17">
     <li data-md>
      <p>If response is not a network error and any of the following returns blocked
...</p>
    </ol>
   </blockquote>
   <p>add the following check to the list:</p>
   <ul>
    <li data-md>
     <p><a data-link-type="dfn" href="#should-block-response" id="ref-for-should-block-response">should internalResponse to request be blocked as attribution trigger</a></p>
   </ul>
   <h2 class="heading settled" data-level="4" id="attribution-reporting-api"><span class="secno">4. </span><span class="content">Attribution Reporting API</span><a class="self-link" href="#attribution-reporting-api"></a></h2>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-attributionsourceparams"><code><c- g>AttributionSourceParams</c-></code></dfn> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVStringâ¡"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="AttributionSourceParams" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-attributionsourceparams-attributiondestination"><code><c- g>attributionDestination</c-></code></dfn>;
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMStringâ "><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="AttributionSourceParams" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-attributionsourceparams-attributionsourceeventid"><code><c- g>attributionSourceEventId</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVStringâ¢"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="AttributionSourceParams" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-attributionsourceparams-attributionreportto"><code><c- g>attributionReportTo</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-longâ£"><c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="AttributionSourceParams" data-dfn-type="dict-member" data-export data-type="long long " id="dom-attributionsourceparams-attributionexpiry"><code><c- g>attributionExpiry</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-longâ¤"><c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="AttributionSourceParams" data-dfn-type="dict-member" data-export data-type="long long " id="dom-attributionsourceparams-attributionsourcepriority"><code><c- g>attributionSourcePriority</c-></code></dfn>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="attributionreporting"><code><c- g>AttributionReporting</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-attributionreporting-registerattributionsource" id="ref-for-dom-attributionreporting-registerattributionsource"><c- g>registerAttributionSource</c-></a>(<a data-link-type="idl-name" href="#dictdef-attributionsourceparams" id="ref-for-dictdef-attributionsourceparams"><c- n>AttributionSourceParams</c-></a> <dfn class="idl-code" data-dfn-for="AttributionReporting/registerAttributionSource(params)" data-dfn-type="argument" data-export id="dom-attributionreporting-registerattributionsource-params-params"><code><c- g>params</c-></code><a class="self-link" href="#dom-attributionreporting-registerattributionsource-params-params"></a></dfn>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContextâ "><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window"><c- g>Window</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#attributionreporting" id="ref-for-attributionreporting"><c- n>AttributionReporting</c-></a> <dfn class="idl-code" data-dfn-for="Window" data-dfn-type="attribute" data-export data-readonly data-type="AttributionReporting" id="dom-window-attributionreporting"><code><c- g>attributionReporting</c-></code><a class="self-link" href="#dom-window-attributionreporting"></a></dfn>;
};
</pre>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="AttributionReporting" data-dfn-type="method" data-export id="dom-attributionreporting-registerattributionsource"><code>registerAttributionSource(<var>params</var>)</code></dfn> method steps are:</p>
   <ol>
    <li data-md>
     <p>Let <var>source</var> be the result of running <a data-link-type="dfn" href="#obtain-an-attribution-source-from-params" id="ref-for-obtain-an-attribution-source-from-params">obtain an attribution source from params</a> with <var>params</var> and the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>.</p>
    <li data-md>
     <p>If <var>source</var> is null, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with">a promise rejected with</a> the <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefinedâ ">undefined</a></code> value.</p>
    <li data-md>
     <p>Set <var>source</var> to the result of running <a data-link-type="dfn" href="#obtain-an-event-attribution-source-from-a-source" id="ref-for-obtain-an-event-attribution-source-from-a-source">obtain an event attribution source from a source</a> with <var>source</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="#process-an-attribution-source" id="ref-for-process-an-attribution-source">process an attribution source</a> with <var>source</var>.</p>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with">a promise resolved with</a> the <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefinedâ¡">undefined</a></code> value.</p>
   </ol>
   <p class="note" role="note"><span>Note:</span> This function returns a promise even though the promise is always resolved or rejected by the
time the function returns; in the future, the promise may be resolved with a value that provides
finer-grained detail about other errors that occurred during the <a data-link-type="dfn" href="#process-an-attribution-source" id="ref-for-process-an-attribution-sourceâ ">process an attribution source</a> step.</p>
   <h2 class="heading settled" data-level="5" id="permission-policy-integration"><span class="secno">5. </span><span class="content">Permissions Policy integration</span><a class="self-link" href="#permission-policy-integration"></a></h2>
    This specification defines a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature">policy-controlled feature</a> identified by the string "<code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-reporting">attribution-reporting</dfn></code>". Its <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#default-allowlist" id="ref-for-default-allowlist">default allowlist</a> is *. 
   <h2 class="heading settled" data-level="6" id="structures"><span class="secno">6. </span><span class="content">Structures</span><a class="self-link" href="#structures"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="6.1" data-lt="Attribution mode" data-noexport id="attribution-mode"><span class="secno">6.1. </span><span class="content">Attribution mode</span><a class="self-link" href="#attribution-mode" id="ref-for-attribution-mode"></a></h3>
   <p>An attribution mode is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#tuple" id="ref-for-tuple">tuple</a> consisting of a mode and a random trigger data. The mode is
either "<code>truthfully</code>", "<code>never</code>", or "<code>falsely</code>". The random trigger data is a non-negative 64-bit
integer, if the mode is "<code>falsely</code>", or null otherwise.</p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="6.2" data-lt="Attribution source" data-noexport id="attribution-source"><span class="secno">6.2. </span><span class="content">Attribution source</span><a class="self-link" href="#attribution-source" id="ref-for-attribution-sourceâ¡â¢"></a></h3>
   <p>An attribution source is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-identifier">source identifier</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-origin">source origin</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ¡">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-event-id">event id</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-site">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-reporting-endpoint">reporting endpoint</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ¢">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-type">source type</dfn>
    <dd data-md>
     <p>Either "<code>navigation</code>" or "<code>event</code>".</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-expiry">expiry</dfn>
    <dd data-md>
     <p>A length of time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-priority">priority</dfn>
    <dd data-md>
     <p>A 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-source-time">source time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-number-of-reports">number of reports</dfn>
    <dd data-md>
     <p>Number of <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ¡">attribution reports</a> created for this <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¨">attribution source</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-dedup-keys">dedup keys</dfn>
    <dd data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">ordered set</a> of <a data-link-type="dfn" href="#attribution-trigger-dedup-key" id="ref-for-attribution-trigger-dedup-key">dedup keys</a> associated with this <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ âª">attribution source</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-attribution-mode">attribution mode</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="#attribution-mode" id="ref-for-attribution-modeâ£">attribution mode</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-randomized-trigger-rate">randomized trigger rate</dfn>
    <dd data-md>
     <p>A number between 0 and 1 (both inclusive).</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="6.3" data-lt="Attribution trigger" data-noexport id="attribution-trigger"><span class="secno">6.3. </span><span class="content">Attribution trigger</span><a class="self-link" href="#attribution-trigger" id="ref-for-attribution-triggerâ¦"></a></h3>
   <p>An attribution trigger is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-structâ ">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-siteâ ">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-navigation-source-trigger-data">navigation-source trigger data</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-event-source-trigger-data">event-source trigger data</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-trigger-time">trigger time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-reporting-endpoint">reporting endpoint</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ£">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-dedup-key">dedup key</dfn>
    <dd data-md>
     <p>Null or a 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution trigger" data-dfn-type="dfn" data-noexport id="attribution-trigger-priority">priority</dfn>
    <dd data-md>
     <p>A 64-bit integer.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="6.4" data-lt="Attribution report" data-noexport id="attribution-report"><span class="secno">6.4. </span><span class="content">Attribution report</span><a class="self-link" href="#attribution-report" id="ref-for-attribution-reportâ â¡"></a></h3>
   <p>An attribution report is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-structâ¡">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-event-id">event id</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-source-type">source type</dfn>
    <dd data-md>
     <p>Either "<code>navigation</code>" or "<code>event</code>".</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-trigger-data">trigger data</dfn>
    <dd data-md>
     <p>A non-negative 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-randomized-trigger-rate">randomized trigger rate</dfn>
    <dd data-md>
     <p>A number between 0 and 1 (both inclusive).</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-reporting-endpoint">reporting endpoint</dfn>
    <dd data-md>
     <p>An <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ¤">origin</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-siteâ¡">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-report-time">report time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-trigger-priority">trigger priority</dfn>
    <dd data-md>
     <p>A 64-bit integer.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-trigger-time">trigger time</dfn>
    <dd data-md>
     <p>A point in time.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-source-identifier">source identifier</dfn>
    <dd data-md>
     <p>A string.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-delivered">delivered</dfn> (default false)
    <dd data-md>
     <p>A boolean.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution report" data-dfn-type="dfn" data-noexport id="attribution-report-report-id">report id</dfn>
    <dd data-md>
     <p>A string.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="6.5" data-lt="Attribution rate-limit record" data-noexport id="attribution-rate-limit-record"><span class="secno">6.5. </span><span class="content">Attribution rate-limit record</span><a class="self-link" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-record"></a></h3>
   <p>An attribution rate-limit record is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-structâ¢">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-source-site">source site</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-siteâ¢">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-attribution-destination">attribution destination</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#site" id="ref-for-siteâ£">site</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-source-type">source type</dfn>
    <dd data-md>
     <p>Either "<code>navigation</code>" or "<code>event</code>".</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="attribution rate-limit record" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-record-trigger-time">trigger time</dfn>
    <dd data-md>
     <p>A point in time.</p>
   </dl>
   <h2 class="heading settled" data-level="7" id="storage"><span class="secno">7. </span><span class="content">Storage</span><a class="self-link" href="#storage"></a></h2>
   <p>A user agent holds an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-source-cache">attribution source cache</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-setâ ">ordered set</a> of <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â ">attribution sources</a>.</p>
   <p>A user agent holds an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-report-cache">attribution report cache</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-setâ¡">ordered set</a> of <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ¢">attribution reports</a>.</p>
   <p>A user agent holds an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-cache">attribution rate-limit cache</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-setâ¢">ordered set</a> of <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-recordâ¡">attribution rate-limit records</a>.</p>
   <p>The above caches are collectively known as the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-caches">attribution caches</dfn>. The <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-caches">attribution caches</a> are
shared among all <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings objects</a>.</p>
   <p class="note" role="note"><span>Note:</span> This would ideally use <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-bottle" id="ref-for-storage-bottle">storage bottles</a> to provide access to the attribution caches.
However attribution data is inherently cross-site, and operations on storage would need to span across all storage bottle maps.</p>
   <h2 class="heading settled" data-level="8" id="general-algorithms"><span class="secno">8. </span><span class="content">General Algorithms</span><a class="self-link" href="#general-algorithms"></a></h2>
   <h3 class="heading settled" data-level="8.1" id="obtaining-randomized-response"><span class="secno">8.1. </span><span class="content">Obtaining a randomized response</span><a class="self-link" href="#obtaining-randomized-response"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-randomized-response">obtain a randomized response</dfn> given <var>trueValue</var>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-setâ£">set</a> <var>possibleValues</var>, and a
double <var>randomPickRate</var>:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: <var>randomPickRate</var> is between 0 and 1 (both inclusive).</p>
    <li data-md>
     <p>Let <var>r</var> be a random double between 0 (inclusive) and 1 (exclusive) with uniform probability.</p>
    <li data-md>
     <p>If <var>r</var> is less than <var>randomPickRate</var>, return a random item from <var>possibleValues</var> with uniform
probability.</p>
    <li data-md>
     <p>Otherwise, return <var>trueValue</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="9" id="source-algorithms"><span class="secno">9. </span><span class="content">Source Algorithms</span><a class="self-link" href="#source-algorithms"></a></h2>
   <h3 class="heading settled" data-level="9.1" id="obtaining-attribution-source-expiry-time"><span class="secno">9.1. </span><span class="content">Obtaining an attribution sourceâs expiry time</span><a class="self-link" href="#obtaining-attribution-source-expiry-time"></a></h3>
   <p>An <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â¡">attribution source</a> <var>source</var>âs <dfn class="dfn-paneled" data-dfn-for="attribution source" data-dfn-type="dfn" data-noexport id="attribution-source-expiry-time">expiry time</dfn> is <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-time">source time</a> + <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiry">expiry</a>.</p>
   <h3 class="heading settled algorithm" data-algorithm="Parsing data fields" data-level="9.2" id="parsing-data-fields"><span class="secno">9.2. </span><span class="content">Parsing data fields</span><a class="self-link" href="#parsing-data-fields"></a></h3>
   <p>This section defines how to parse strings into integers for <a data-link-type="dfn" href="#attribution-source-event-id" id="ref-for-attribution-source-event-id">event id</a>, <a data-link-type="dfn" href="#attribution-trigger-navigation-source-trigger-data" id="ref-for-attribution-trigger-navigation-source-trigger-data">navigation-source trigger data</a>, and <a data-link-type="dfn" href="#attribution-trigger-event-source-trigger-data" id="ref-for-attribution-trigger-event-source-trigger-data">event-source trigger data</a>.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-attribution-data">parse attribution data</dfn> given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-stringâ ">string</a> <var>input</var> modulo an integer <var>maxData</var> perform the following steps. They return a non-negative integer:</p>
   <ol>
    <li data-md>
     <p>Let <var>decodedInput</var> be the result of applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers" id="ref-for-rules-for-parsing-non-negative-integersâ ">rules for parsing non-negative integers</a> to <var>input</var>.</p>
    <li data-md>
     <p>If <var>decodedInput</var> is an error, return zero.</p>
    <li data-md>
     <p>If <var>decodedInput</var> is greater than 2<sup>64</sup>, return zero.</p>
    <li data-md>
     <p>Let <var>clampedDecodedInput</var> be the remainder when dividing <var>decodedInput</var> by <var>maxData</var>.</p>
    <li data-md>
     <p>Return <var>clampedDecodedInput</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Parsing an attribution destination" data-level="9.3" id="parsing-attribution-destination"><span class="secno">9.3. </span><span class="content">Parsing an attribution destination</span><a class="self-link" href="#parsing-attribution-destination"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-an-attribution-destination">parse an attribution destination</dfn> from a string <var>str</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>url</var> be the result of running the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a> on the value of
the <var>str</var>.</p>
    <li data-md>
     <p>If <var>url</var> is failure or null, return null.</p>
    <li data-md>
     <p>If <var>url</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ¥">origin</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>, return null.</p>
    <li data-md>
     <p>Return the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site" id="ref-for-obtain-a-site">obtaining a site</a> from <var>url</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ¦">origin</a>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining a random attribution mode" data-level="9.4" id="obtaining-random-attribution-mode"><span class="secno">9.4. </span><span class="content">Obtaining a random attribution mode</span><a class="self-link" href="#obtaining-random-attribution-mode"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-random-attribution-mode">obtain a random attribution mode</dfn> given a positive integer <var>triggerDataCardinality</var> and a double <var>randomPickRate</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>possibleValues</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-setâ¤">set</a> of <a data-link-type="dfn" href="#attribution-mode" id="ref-for-attribution-modeâ ">attribution modes</a> Â« (<code>"never"</code>, null) Â».</p>
    <li data-md>
     <p>For each integer <var>i</var> between 0 (inclusive) and <var>triggerDataCardinality</var> (exclusive):</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> the <a data-link-type="dfn" href="#attribution-mode" id="ref-for-attribution-modeâ¡">attribution mode</a> (<code>"falsely"</code>, <var>i</var>) to <var>possibleValues</var>.</p>
     </ol>
    <li data-md>
     <p>Return the result of <a data-link-type="dfn" href="#obtain-a-randomized-response" id="ref-for-obtain-a-randomized-response">obtaining a randomized response</a> with the <a data-link-type="dfn" href="#attribution-mode" id="ref-for-attribution-modeâ¢">attribution mode</a> (<code>"truthfully"</code>, null), <var>possibleValues</var>, and <var>randomPickRate</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining an attribution source from an a element" data-level="9.5" id="obtaining-attribution-source-anchor"><span class="secno">9.5. </span><span class="content">Obtaining an attribution source from an <code>a</code> element</span><a class="self-link" href="#obtaining-attribution-source-anchor"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-attribution-source-from-an-anchor">obtain an attribution source from an anchor</dfn> given an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ¨">a</a></code> element <var>anchor</var>:</p>
   <ol>
    <li data-md>
     <p>If anchor does not have both an <code><a data-link-type="element-sub" href="#element-attrdef-a-attributiondestination" id="ref-for-element-attrdef-a-attributiondestinationâ£">attributiondestination</a></code> attribute and an <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionsourceeventid" id="ref-for-element-attrdef-a-attributionsourceeventidâ¡">attributionsourceeventid</a></code> attribute, return null.</p>
    <li data-md>
     <p>Let <var>params</var> be an <code class="idl"><a data-link-type="idl" href="#dictdef-attributionsourceparams" id="ref-for-dictdef-attributionsourceparamsâ ">AttributionSourceParams</a></code> with the following key/value pairs:</p>
     <dl>
      <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributiondestination" id="ref-for-dom-attributionsourceparams-attributiondestination">attributionDestination</a></code>
      <dd data-md>
       <p><var>anchor</var>âs <code><a data-link-type="element-sub" href="#element-attrdef-a-attributiondestination" id="ref-for-element-attrdef-a-attributiondestinationâ¤">attributiondestination</a></code> attribute</p>
      <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionsourceeventid" id="ref-for-dom-attributionsourceparams-attributionsourceeventid">attributionSourceEventId</a></code>
      <dd data-md>
       <p><var>anchor</var>âs <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionsourceeventid" id="ref-for-element-attrdef-a-attributionsourceeventidâ¢">attributionsourceeventid</a></code> attribute</p>
      <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionreportto" id="ref-for-dom-attributionsourceparams-attributionreportto">attributionReportTo</a></code>
      <dd data-md>
       <p><var>anchor</var>âs <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionreportto" id="ref-for-element-attrdef-a-attributionreporttoâ ">attributionreportto</a></code> attribute</p>
      <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionexpiry" id="ref-for-dom-attributionsourceparams-attributionexpiry">attributionExpiry</a></code>
      <dd data-md>
       <p><var>anchor</var>âs <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionexpiry" id="ref-for-element-attrdef-a-attributionexpiryâ¡">attributionexpiry</a></code> attribute</p>
      <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionsourcepriority" id="ref-for-dom-attributionsourceparams-attributionsourcepriority">attributionSourcePriority</a></code>
      <dd data-md>
       <p><var>anchor</var>âs <code><a data-link-type="element-sub" href="#element-attrdef-a-attributionsourcepriority" id="ref-for-element-attrdef-a-attributionsourcepriorityâ ">attributionsourcepriority</a></code> attribute</p>
     </dl>
    <li data-md>
     <p>Return the result of running <a data-link-type="dfn" href="#obtain-an-attribution-source-from-params" id="ref-for-obtain-an-attribution-source-from-paramsâ ">obtain an attribution source from params</a> with <var>params</var> and <var>anchor</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-objectâ ">relevant settings object</a>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining an event attribution source from an a element" data-level="9.6" id="obtaining-event-attribution-source-anchor"><span class="secno">9.6. </span><span class="content">Obtaining an event attribution source from an <code>a</code> element</span><a class="self-link" href="#obtaining-event-attribution-source-anchor"></a></h3>
   <p>To <dfn data-dfn-type="dfn" data-noexport id="obtain-an-event-attribution-source-from-an-anchor">obtain an event attribution source from an anchor<a class="self-link" href="#obtain-an-event-attribution-source-from-an-anchor"></a></dfn> given an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-elementâ âª">a</a></code> element <var>anchor</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>anchor</var> does not have a <code><a data-link-type="element-sub" href="#element-attrdef-a-registerattributionsource" id="ref-for-element-attrdef-a-registerattributionsourceâ¡">registerattributionsource</a></code> attribute, return null.</p>
    <li data-md>
     <p>Let <var>source</var> be the result of running <a data-link-type="dfn" href="#obtain-an-attribution-source-from-an-anchor" id="ref-for-obtain-an-attribution-source-from-an-anchorâ ">obtain an attribution source from an anchor</a> with <var>anchor</var>.</p>
    <li data-md>
     <p>If <var>source</var> is null, return null.</p>
    <li data-md>
     <p>Return the result of running <a data-link-type="dfn" href="#obtain-an-event-attribution-source-from-a-source" id="ref-for-obtain-an-event-attribution-source-from-a-sourceâ ">obtain an event attribution source from a source</a> with <var>source</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining an event attribution source from a source" data-level="9.7" id="obtaining-event-attribution-source-source"><span class="secno">9.7. </span><span class="content">Obtaining an event attribution source from a source</span><a class="self-link" href="#obtaining-event-attribution-source-source"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-event-attribution-source-from-a-source">obtain an event attribution source from a source</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â¢">attribution source</a> <var>source</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>resultSource</var> be a shallow clone of <var>source</var>.</p>
    <li data-md>
     <p>Set <var>resultSource</var>âs <a data-link-type="dfn" href="#attribution-source-source-identifier" id="ref-for-attribution-source-source-identifier">source identifier</a> to a new unique opaque string.</p>
    <li data-md>
     <p>Set <var>resultSource</var>âs <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ ">source type</a> to "<code>event</code>".</p>
    <li data-md>
     <p>Round <var>resultSource</var>âs <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiryâ ">expiry</a> away from zero to the nearest day (86400 seconds).</p>
    <li data-md>
     <p>Set <var>resultSource</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-mode" id="ref-for-attribution-source-attribution-mode">attribution mode</a> to the result of <a data-link-type="dfn" href="#obtain-a-random-attribution-mode" id="ref-for-obtain-a-random-attribution-mode">obtaining a random attribution mode</a> with the user agentâs <a data-link-type="dfn" href="#event-source-trigger-data-cardinality" id="ref-for-event-source-trigger-data-cardinality">event-source trigger data cardinality</a> and the user agentâs <a data-link-type="dfn" href="#randomized-event-source-trigger-rate" id="ref-for-randomized-event-source-trigger-rate">randomized event-source trigger rate</a>.</p>
    <li data-md>
     <p>Set <var>resultSource</var>âs <a data-link-type="dfn" href="#attribution-source-randomized-trigger-rate" id="ref-for-attribution-source-randomized-trigger-rate">randomized trigger rate</a> to the user agentâs <a data-link-type="dfn" href="#randomized-event-source-trigger-rate" id="ref-for-randomized-event-source-trigger-rateâ ">randomized event-source trigger rate</a>.</p>
    <li data-md>
     <p>Return <var>resultSource</var>.</p>
   </ol>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="randomized-event-source-trigger-rate">Randomized event-source trigger rate</dfn> is a vendor-specific double between 0 and 1 (both
inclusive) that controls the randomized response probability for the <a data-link-type="dfn" href="#attribution-source-attribution-mode" id="ref-for-attribution-source-attribution-modeâ ">attribution mode</a> of an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â£">attribution source</a> whose <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ¡">source type</a> is "<code>event</code>".</p>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining an attribution source from AttributionSourceParams" data-level="9.8" id="obtaining-attribution-source-params"><span class="secno">9.8. </span><span class="content">Obtaining an attribution source from <code class="idl"><a data-link-type="idl" href="#dictdef-attributionsourceparams" id="ref-for-dictdef-attributionsourceparamsâ¡">AttributionSourceParams</a></code></span><a class="self-link" href="#obtaining-attribution-source-params"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-attribution-source-from-params">obtain an attribution source from params</dfn> given an <code class="idl"><a data-link-type="idl" href="#dictdef-attributionsourceparams" id="ref-for-dictdef-attributionsourceparamsâ¢">AttributionSourceParams</a></code> <var>params</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-objectâ ">environment settings object</a> <var>settings</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>sourceIdentifier</var> be a new unique string.</p>
    <li data-md>
     <p>Let <var>currentTime</var> be the current time.</p>
    <li data-md>
     <p class="assertion">Assert: <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributiondestination" id="ref-for-dom-attributionsourceparams-attributiondestinationâ ">attributionDestination</a></code>"] and <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionsourceeventid" id="ref-for-dom-attributionsourceparams-attributionsourceeventidâ ">attributionSourceEventId</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exist</a>.</p>
    <li data-md>
     <p>If <var>settings</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window" id="ref-for-concept-document-window">associated Document</a> is
not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use" id="ref-for-allowed-to-use">allowed to use</a> the <a data-link-type="dfn" href="#attribution-reporting" id="ref-for-attribution-reporting">attribution-reporting</a> <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-featureâ ">policy-controlled feature</a>, return null.</p>
    <li data-md>
     <p>Let <var>attributionDestination</var> be the result of running <a data-link-type="dfn" href="#parse-an-attribution-destination" id="ref-for-parse-an-attribution-destination">parse an attribution destination</a> with <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributiondestination" id="ref-for-dom-attributionsourceparams-attributiondestinationâ¡">attributionDestination</a></code>"].</p>
    <li data-md>
     <p>If <var>attributionDestination</var> is null, return null.</p>
    <li data-md>
     <p>Let <var>sourceOrigin</var> be <var>settings</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-origin">top-level origin</a>.</p>
    <li data-md>
     <p>If <var>sourceOrigin</var> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaqueâ ">opaque origin</a>, return null.</p>
    <li data-md>
     <p>Let <var>reportingOrigin</var> be <var>sourceOrigin</var>.</p>
    <li data-md>
     <p>If <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionreportto" id="ref-for-dom-attributionsourceparams-attributionreporttoâ ">attributionReportTo</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-existsâ ">exists</a>, then:</p>
     <ol>
      <li data-md>
       <p>Let <var>reportingUrl</var> be the result of running the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parserâ ">URL parser</a> with <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionreportto" id="ref-for-dom-attributionsourceparams-attributionreporttoâ¡">attributionReportTo</a></code>"].</p>
      <li data-md>
       <p>If <var>reportingUrl</var> is failure or null, return null.</p>
      <li data-md>
       <p>If <var>reportingUrl</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ§">origin</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaqueâ¡">opaque origin</a>, return null.</p>
      <li data-md>
       <p>Set <var>reportingOrigin</var> to <var>reportingUrl</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ¨">origin</a>.</p>
     </ol>
    <li data-md>
     <p>Let <var>expiry</var> be 30 days.</p>
    <li data-md>
     <p>If <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionexpiry" id="ref-for-dom-attributionsourceparams-attributionexpiryâ ">attributionExpiry</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-existsâ¡">exists</a>,
then set <var>expiry</var> to that value.</p>
    <li data-md>
     <p>Let <var>priority</var> be 0.</p>
    <li data-md>
     <p>If <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionsourcepriority" id="ref-for-dom-attributionsourceparams-attributionsourcepriorityâ ">attributionSourcePriority</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-existsâ¢">exists</a>,
then set <var>priority</var> to that value.</p>
    <li data-md>
     <p>Let <var>source</var> be a new <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â¤">attribution source</a> struct whose items are:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-identifier" id="ref-for-attribution-source-source-identifierâ ">source identifier</a>
      <dd data-md>
       <p><var>sourceIdentifier</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-origin">source origin</a>
      <dd data-md>
       <p><var>sourceOrigin</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-event-id" id="ref-for-attribution-source-event-idâ ">event id</a>
      <dd data-md>
       <p>The result of running <a data-link-type="dfn" href="#parse-attribution-data" id="ref-for-parse-attribution-data">parse attribution data</a> with <var>params</var>["<code class="idl"><a data-link-type="idl" href="#dom-attributionsourceparams-attributionsourceeventid" id="ref-for-dom-attributionsourceparams-attributionsourceeventidâ¡">attributionSourceEventId</a></code>"] modulo <a data-link-type="dfn" href="#max-event-id-value" id="ref-for-max-event-id-value">max event id value</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ¢">attribution destination</a>
      <dd data-md>
       <p><var>attributionDestination</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpointâ ">reporting endpoint</a>
      <dd data-md>
       <p><var>reportingOrigin</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiryâ¡">expiry</a>
      <dd data-md>
       <p><var>expiry</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priority">priority</a>
      <dd data-md>
       <p><var>priority</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-timeâ ">source time</a>
      <dd data-md>
       <p><var>currentTime</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ¢">source type</a>
      <dd data-md>
       <p>"<code>navigation</code>"</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-attribution-mode" id="ref-for-attribution-source-attribution-modeâ¡">attribution mode</a>
      <dd data-md>
       <p>("<code>truthfully</code>", null)</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-source-randomized-trigger-rate" id="ref-for-attribution-source-randomized-trigger-rateâ ">randomized trigger rate</a>
      <dd data-md>
       <p>0</p>
     </dl>
    <li data-md>
     <p>Return <var>source</var>.</p>
   </ol>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-event-id-value">Max event id value</dfn> is a vendor-specific integer which controls
the maximum value which can be used as an <a data-link-type="dfn" href="#attribution-source-event-id" id="ref-for-attribution-source-event-idâ¡">event id</a>.</p>
   <h3 class="heading settled" data-level="9.9" id="processing-an-attribution-source"><span class="secno">9.9. </span><span class="content">Processing an attribution source</span><a class="self-link" href="#processing-an-attribution-source"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-process-a-navigation-attribution-source">maybe process a navigation attribution source</dfn> given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params" id="ref-for-navigation-paramsâ ">navigation params</a> <var>navigationParams</var> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context">browsing context</a> <var>browsingContext</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>browsingContext</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level browsing context</a>, return.</p>
    <li data-md>
     <p>Let <var>attributionSource</var> be <var>navigationParams</var>âs <a data-link-type="dfn" href="#navigation-params-attribution-source" id="ref-for-navigation-params-attribution-sourceâ¢">attribution source</a>.</p>
    <li data-md>
     <p>If <var>attributionSource</var> is null, return.</p>
    <li data-md>
     <p>If <var>attributionSource</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ£">attribution destination</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-site" id="ref-for-same-siteâ¢">same site</a> to <var>navigationParams</var>âs <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-origin">origin</a>, return.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-taskâ ">Queue a task</a> to <a data-link-type="dfn" href="#process-an-attribution-source" id="ref-for-process-an-attribution-sourceâ¡">process an attribution source</a> with <var>attributionSource</var>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="process-an-attribution-source">process an attribution source</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â¥">attribution source</a> <var>source</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>cache</var> be the user agentâs <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cache">attribution source cache</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">Remove</a> all entries in <var>cache</var> where all of the following are true:</p>
     <ul>
      <li data-md>
       <p>the entryâs <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ¤">attribution destination</a> and <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ¥">attribution destination</a> are equal.</p>
      <li data-md>
       <p>the entryâs <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpointâ¡">reporting endpoint</a> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin">same origin</a> with <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpointâ¢">reporting endpoint</a>.</p>
      <li data-md>
       <p>the entryâs <a data-link-type="dfn" href="#attribution-source-number-of-reports" id="ref-for-attribution-source-number-of-reports">number of reports</a> value is greater than 0.</p>
     </ul>
     <p class="note" role="note"><span>Note:</span> This causes the user agent to favor triggering newer <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â¦">attribution sources</a> over sources that have already been triggered.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-removeâ ">Remove</a> all entries in <var>cache</var> where the entryâs <a data-link-type="dfn" href="#attribution-source-expiry-time" id="ref-for-attribution-source-expiry-time">expiry time</a> is less than the current time.</p>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a> of <var>cache</var> is greater than or equal to the user agentâs <a data-link-type="dfn" href="#max-source-cache-size" id="ref-for-max-source-cache-size">max source cache size</a>, return.</p>
    <li data-md>
     <p>If <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-mode" id="ref-for-attribution-source-attribution-modeâ¢">attribution mode</a>[0] is "<code>falsely</code>", then:</p>
     <ol>
      <li data-md>
       <p class="assertion">Assert: <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ£">source type</a> is "<code>event</code>".</p>
      <li data-md>
       <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-sizeâ ">size</a> of the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cache">attribution report cache</a> is greater than or equal to the user
agentâs <a data-link-type="dfn" href="#max-report-cache-size" id="ref-for-max-report-cache-size">max report cache size</a>, return.</p>
      <li data-md>
       <p>Let <var>fakeTrigger</var> be a new <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-triggerâ¡">attribution trigger</a> with the items:</p>
       <dl>
        <dt data-md><a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destinationâ ">attribution destination</a>
        <dd data-md>
         <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ¦">attribution destination</a></p>
        <dt data-md><a data-link-type="dfn" href="#attribution-trigger-navigation-source-trigger-data" id="ref-for-attribution-trigger-navigation-source-trigger-dataâ ">navigation-source trigger data</a>
        <dd data-md>
         <p>0</p>
        <dt data-md><a data-link-type="dfn" href="#attribution-trigger-event-source-trigger-data" id="ref-for-attribution-trigger-event-source-trigger-dataâ ">event-source trigger data</a>
        <dd data-md>
         <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-mode" id="ref-for-attribution-source-attribution-modeâ£">attribution mode</a>[1]</p>
        <dt data-md><a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-time">trigger time</a>
        <dd data-md>
         <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-timeâ¡">source time</a></p>
        <dt data-md><a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpointâ ">reporting endpoint</a>
        <dd data-md>
         <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpointâ£">reporting endpoint</a></p>
        <dt data-md><a data-link-type="dfn" href="#attribution-trigger-dedup-key" id="ref-for-attribution-trigger-dedup-keyâ ">dedup key</a>
        <dd data-md>
         <p>null</p>
        <dt data-md><a data-link-type="dfn" href="#attribution-trigger-priority" id="ref-for-attribution-trigger-priority">priority</a>
        <dd data-md>
         <p>0</p>
       </dl>
      <li data-md>
       <p>Let <var>fakeReport</var> be the result of running <a data-link-type="dfn" href="#obtain-a-report" id="ref-for-obtain-a-report">obtain a report</a> with <var>source</var> and <var>fakeTrigger</var>.</p>
      <li data-md>
       <p>Add <var>fakeReport</var> to the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ ">attribution report cache</a>.</p>
      <li data-md>
       <p>Return.</p>
     </ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-appendâ ">Append</a> <var>source</var> to <var>cache</var>.</p>
   </ol>
   <p class="issue" id="issue-82e83119"><a class="self-link" href="#issue-82e83119"></a> Should fake reports respect the user agentâs <a data-link-type="dfn" href="#max-reports-per-attribution-destination" id="ref-for-max-reports-per-attribution-destination">max reports per attribution destination</a>?</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-source-cache-size">Max source cache size</dfn> is a vendor-specific integer which controls how many <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â§">attribution sources</a> can be in the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cacheâ ">attribution source cache</a>.</p>
   <h2 class="heading settled" data-level="10" id="trigger-algorithms"><span class="secno">10. </span><span class="content">Triggering Algorithms</span><a class="self-link" href="#trigger-algorithms"></a></h2>
   <h3 class="heading settled algorithm" data-algorithm="Creating an attribution trigger" data-level="10.1" id="attribution-trigger-creation"><span class="secno">10.1. </span><span class="content">Creating an attribution trigger</span><a class="self-link" href="#attribution-trigger-creation"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-an-attribution-trigger">obtain an attribution trigger</dfn> given a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a> <var>url</var> and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-objectâ¡">environment settings object</a> <var>environment</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>navigationSourceTriggerData</var> be 0.</p>
    <li data-md>
     <p>If <var>url</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-query" id="ref-for-concept-url-query">query</a> has a "<code>trigger-data</code>" field, set <var>navigationSourceTriggerData</var> to the result of running <a data-link-type="dfn" href="#parse-attribution-data" id="ref-for-parse-attribution-dataâ ">parse attribution data</a> with
the value associated with the field modulo the user agentâs <a data-link-type="dfn" href="#trigger-data-cardinality" id="ref-for-trigger-data-cardinality">trigger data cardinality</a>.</p>
    <li data-md>
     <p>Let <var>eventSourceTriggerData</var> be 0.</p>
    <li data-md>
     <p>If <var>url</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-query" id="ref-for-concept-url-queryâ ">query</a> has an "<code>event-source-trigger-data</code>" field, set <var>eventSourceTriggerData</var> to the result of running <a data-link-type="dfn" href="#parse-attribution-data" id="ref-for-parse-attribution-dataâ¡">parse attribution data</a> with
the value associated with the field modulo the user agentâs <a data-link-type="dfn" href="#event-source-trigger-data-cardinality" id="ref-for-event-source-trigger-data-cardinalityâ ">event-source trigger data cardinality</a>.</p>
    <li data-md>
     <p>Let <var>dedupKey</var> be null.</p>
    <li data-md>
     <p>If <var>url</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-query" id="ref-for-concept-url-queryâ¡">query</a> has a "<code>dedup-key</code>" field, and applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers" id="ref-for-rules-for-parsing-integersâ ">rules for
parsing integers</a> to the fieldâs value results in an integer, then set <var>dedupKey</var> to that
value.</p>
    <li data-md>
     <p>Let <var>triggerPriority</var> be 0.</p>
    <li data-md>
     <p>If <var>url</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-query" id="ref-for-concept-url-queryâ¢">query</a> has a "<code>priority</code>" field, and applying the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers" id="ref-for-rules-for-parsing-integersâ¡">rules for parsing integers</a> to the fieldâs value results
in an integer, set <var>triggerPriority</var> to that value.</p>
    <li data-md>
     <p>Let <var>trigger</var> be a new <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-triggerâ¢">attribution trigger</a> with the items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destinationâ¡">attribution destination</a>
      <dd data-md>
       <p>The result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site" id="ref-for-obtain-a-siteâ ">obtaining a site</a> from <var>environment</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-originâ ">top-level origin</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-navigation-source-trigger-data" id="ref-for-attribution-trigger-navigation-source-trigger-dataâ¡">navigation-source trigger data</a>
      <dd data-md>
       <p><var>navigationSourceTriggerData</var>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-event-source-trigger-data" id="ref-for-attribution-trigger-event-source-trigger-dataâ¡">event-source trigger data</a>
      <dd data-md>
       <p><var>eventSourceTriggerData</var>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-timeâ ">trigger time</a>
      <dd data-md>
       <p>The current time.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpointâ¡">reporting endpoint</a>
      <dd data-md>
       <p><var>url</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ âª">origin</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-dedup-key" id="ref-for-attribution-trigger-dedup-keyâ¡">dedup key</a>
      <dd data-md>
       <p><var>dedupKey</var>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-trigger-priority" id="ref-for-attribution-trigger-priorityâ ">priority</a>
      <dd data-md>
       <p><var>triggerPriority</var>.</p>
     </dl>
    <li data-md>
     <p>Return <var>trigger</var>.</p>
   </ol>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="trigger-data-cardinality">Trigger data cardinality</dfn> is a vendor-specific integer that controls the valid range of <a data-link-type="dfn" href="#attribution-trigger-navigation-source-trigger-data" id="ref-for-attribution-trigger-navigation-source-trigger-dataâ¢">navigation-source trigger data</a>:
0 &lt;= <a data-link-type="dfn" href="#attribution-trigger-navigation-source-trigger-data" id="ref-for-attribution-trigger-navigation-source-trigger-dataâ£">navigation-source trigger data</a> &lt; <a data-link-type="dfn" href="#trigger-data-cardinality" id="ref-for-trigger-data-cardinalityâ ">trigger data cardinality</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event-source-trigger-data-cardinality">Event-source trigger data cardinality</dfn> is a vendor-specific integer that controls the valid
range of <a data-link-type="dfn" href="#attribution-trigger-event-source-trigger-data" id="ref-for-attribution-trigger-event-source-trigger-dataâ¢">event-source trigger data</a>:
0 &lt;= <a data-link-type="dfn" href="#attribution-trigger-event-source-trigger-data" id="ref-for-attribution-trigger-event-source-trigger-dataâ£">event-source trigger data</a> &lt; <a data-link-type="dfn" href="#event-source-trigger-data-cardinality" id="ref-for-event-source-trigger-data-cardinalityâ¡">event-source trigger data cardinality</a>.</p>
   <p class="issue" id="issue-9d1372db"><a class="self-link" href="#issue-9d1372db"></a> Formalize how to parse the query similar to URLSearchParams.</p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="10.2" data-lt="Should internalResponse to request be blocked as attribution trigger" data-noexport id="should-block-response"><span class="secno">10.2. </span><span class="content">Should internalResponse to request be blocked as attribution trigger</span><a class="self-link" href="#should-block-response" id="ref-for-should-block-responseâ "></a></h3>
   <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> <var>request</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url">current URLâs</a> <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ â ">origin</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaqueâ¢">opaque origin</a>, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-urlâ ">current URLâs</a> <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-path">path</a> is not equal to Â« ".well-known","attribution-reporting","trigger-attribution" Â»,
return <strong>allowed</strong>.</p>
    <li data-md>
     <p>Let <var>environment</var> be <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window">window</a>.</p>
    <li data-md>
     <p>If <var>environment</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-objectâ¢">environment settings object</a>, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>environment</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-globalâ ">relevant global object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window" id="ref-for-concept-document-windowâ ">associated Document</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use" id="ref-for-allowed-to-useâ ">allowed to use</a> the <a data-link-type="dfn" href="#attribution-reporting" id="ref-for-attribution-reportingâ ">attribution-reporting</a> <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-featureâ¡">policy-controlled feature</a>,
return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>environment</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin">origin</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin">potentially trustworthy origin</a>, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>environment</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-originâ¡">top-level origin</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaqueâ£">opaque origin</a>, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>environment</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-originâ¢">top-level origin</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-originâ ">potentially trustworthy origin</a>, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-urlâ¡">current URLâs</a> <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ â¡">origin</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-originâ¡">potentially trustworthy origin</a>, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>If <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-count" id="ref-for-concept-request-redirect-count">redirect count</a> is less than 1, return <strong>allowed</strong>.</p>
    <li data-md>
     <p>Let <var>previousUrl</var> be the second to last <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-urlâ ">URL</a> in <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url-list" id="ref-for-concept-request-url-list">URL list</a>.</p>
    <li data-md>
     <p>If <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-urlâ¢">current URLâs</a> <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ â¢">origin</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-originâ ">same origin</a> with <var>previousUrl</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ â£">origin</a>, return <strong>allowed</strong>.</p>
     <p class="note" role="note"><span>Note:</span> The restriction to require a redirect is necessary to ensure that the
 requestâs origin is aware and in control of the conversion registration. This could also be done with a <a href="https://github.com/WICG/conversion-measurement-api/issues/91">header-based mechanism</a>.</p>
    <li data-md>
     <p>Let <var>trigger</var> be the result of running <a data-link-type="dfn" href="#obtain-an-attribution-trigger" id="ref-for-obtain-an-attribution-trigger">obtain an attribution trigger</a> with <var>request</var>âs <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-urlâ£">current URL</a> and <var>environment</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-taskâ¡">Queue a task</a> to <a data-link-type="dfn" href="#trigger-attribution" id="ref-for-trigger-attribution">trigger attribution</a> with <var>trigger</var>.</p>
    <li data-md>
     <p>Return <strong>blocked</strong>.</p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="10.3" data-lt="Should attribution be blocked by rate limit" data-noexport id="should-rate-limit-attribution"><span class="secno">10.3. </span><span class="content">Should attribution be blocked by rate limit</span><a class="self-link" href="#should-rate-limit-attribution" id="ref-for-should-rate-limit-attribution"></a></h3>
   <p>Given an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-triggerâ£">attribution trigger</a> <var>trigger</var> and <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ â¨">attribution source</a> <var>sourceToAttribute</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>sourceSite</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site" id="ref-for-obtain-a-siteâ¡">obtaining a site</a> from <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-originâ ">source origin</a>.</p>
    <li data-md>
     <p>Let <var>matchingRateLimitRecords</var> be all entries in the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cache">attribution rate-limit cache</a> where all of the following are true:</p>
     <ul>
      <li data-md>
       <p>entryâs <a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-site">source site</a> and <var>sourceSite</var> are equal</p>
      <li data-md>
       <p>entryâs <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destination">attribution destination</a> and <var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destinationâ¢">attribution destination</a> are equal</p>
      <li data-md>
       <p>entryâs <a data-link-type="dfn" href="#attribution-rate-limit-record-source-type" id="ref-for-attribution-rate-limit-record-source-type">source type</a> and <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ¤">source type</a> are equal</p>
      <li data-md>
       <p>entryâs <a data-link-type="dfn" href="#attribution-rate-limit-record-trigger-time" id="ref-for-attribution-rate-limit-record-trigger-time">trigger time</a> is at least <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-window">attribution rate-limit window</a> before <var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-timeâ¡">trigger time</a></p>
     </ul>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-sizeâ¡">size</a> of <var>matchingRateLimitRecords</var> is greater than or equal to <a data-link-type="dfn" href="#max-attributions-per-rate-limit-window" id="ref-for-max-attributions-per-rate-limit-window">max attributions per rate-limit window</a>, return <strong>blocked</strong>.</p>
    <li data-md>
     <p>Return <strong>allowed</strong>.</p>
   </ol>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attribution-rate-limit-window">Attribution rate-limit window</dfn> is a vendor-specific duration that controls the
rate-limiting window for attribution.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-attributions-per-rate-limit-window">Max attributions per rate-limit window</dfn> is a vendor-specific integer that controls
the maximum number of attributions for a (<a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-siteâ ">source site</a>, <a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destinationâ ">attribution destination</a>, <a data-link-type="dfn" href="#attribution-rate-limit-record-source-type" id="ref-for-attribution-rate-limit-record-source-typeâ ">source type</a>) per <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-windowâ ">attribution rate-limit window</a>.</p>
   <h3 class="heading settled algorithm" data-algorithm="Triggering attribution" data-level="10.4" id="triggering-attribution"><span class="secno">10.4. </span><span class="content">Triggering attribution</span><a class="self-link" href="#triggering-attribution"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="trigger-attribution">trigger attribution</dfn> given an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-triggerâ¤">attribution trigger</a> <var>trigger</var> run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>attributionDestination</var> be <var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-attribution-destination" id="ref-for-attribution-trigger-attribution-destinationâ£">attribution destination</a>.</p>
    <li data-md>
     <p>Let <var>matchingSources</var> be all entries in the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cacheâ¡">attribution source cache</a> where all of the following are true:</p>
     <ul>
      <li data-md>
       <p>entryâs <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ§">attribution destination</a> and <var>attributionDestination</var> are equal.</p>
      <li data-md>
       <p>entryâs <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpointâ¤">reporting endpoint</a> and <var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-reporting-endpoint" id="ref-for-attribution-trigger-reporting-endpointâ¢">reporting endpoint</a> are equal.</p>
      <li data-md>
       <p>entryâs <a data-link-type="dfn" href="#attribution-source-expiry-time" id="ref-for-attribution-source-expiry-timeâ ">expiry time</a> is greater than the current time.</p>
     </ul>
    <li data-md>
     <p>If <var>matchingSources</var> is empty, return.</p>
    <li data-md>
     <p>Set <var>matchingSources</var> to the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-sort-in-descending-order" id="ref-for-list-sort-in-descending-order">sorting</a> <var>matchingSources</var> in descending order, with <var>a</var> being less than <var>b</var> if any of the following are true:</p>
     <ul>
      <li data-md>
       <p><var>a</var>âs <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priorityâ ">priority</a> is less than <var>b</var>âs <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priorityâ¡">priority</a>.</p>
      <li data-md>
       <p><var>a</var>âs <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priorityâ¢">priority</a> is equal to <var>b</var>âs <a data-link-type="dfn" href="#attribution-source-priority" id="ref-for-attribution-source-priorityâ£">priority</a> and <var>a</var>âs <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-timeâ¢">source time</a> is less than <var>b</var>âs <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-timeâ£">source time</a>.</p>
     </ul>
    <li data-md>
     <p>Let <var>sourceToAttribute</var> be the first item in <var>matchingSources</var>.</p>
    <li data-md>
     <p class="assertion">Assert: <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-mode" id="ref-for-attribution-source-attribution-modeâ¤">attribution mode</a>[0] is
"<code>truthfully</code>" or "<code>never</code>".</p>
    <li data-md>
     <p>If <var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-dedup-key" id="ref-for-attribution-trigger-dedup-keyâ¢">dedup key</a> is not null and <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-dedup-keys" id="ref-for-attribution-source-dedup-keys">dedup keys</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contains</a> it, return.</p>
    <li data-md>
     <p>Let <var>numMatchingReports</var> be the number of entries in the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ¡">attribution report cache</a> whose <a data-link-type="dfn" href="#attribution-report-attribution-destination" id="ref-for-attribution-report-attribution-destination">attribution destination</a> equals <var>attributionDestination</var>.</p>
    <li data-md>
     <p>If <var>numMatchingReports</var> is greater than or equal to the user agentâs <a data-link-type="dfn" href="#max-reports-per-attribution-destination" id="ref-for-max-reports-per-attribution-destinationâ ">max reports per attribution destination</a>, return.</p>
    <li data-md>
     <p>If the result of running <a data-link-type="dfn" href="#should-rate-limit-attribution" id="ref-for-should-rate-limit-attributionâ ">should attribution be blocked by rate limit</a> with <var>trigger</var> and <var>sourceToAttribute</var> is <strong>blocked</strong>, return.</p>
    <li data-md>
     <p>Let <var>report</var> be the result of running <a data-link-type="dfn" href="#obtain-a-report" id="ref-for-obtain-a-reportâ ">obtain a report</a> with <var>sourceToAttribute</var> and <var>trigger</var>.</p>
    <li data-md>
     <p>If <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-number-of-reports" id="ref-for-attribution-source-number-of-reportsâ ">number of reports</a> value is equal to the
user agentâs <a data-link-type="dfn" href="#max-reports-per-source" id="ref-for-max-reports-per-source">max reports per source</a> value, then:</p>
     <ol>
      <li data-md>
       <p>Let <var>matchingReports</var> be all entries in the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ¢">attribution report cache</a> where all of the following are true:</p>
       <ul>
        <li data-md>
         <p>entryâs <a data-link-type="dfn" href="#attribution-report-report-time" id="ref-for-attribution-report-report-time">report time</a> and <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-report-time" id="ref-for-attribution-report-report-timeâ ">report time</a> are equal.</p>
        <li data-md>
         <p>entryâs <a data-link-type="dfn" href="#attribution-report-source-identifier" id="ref-for-attribution-report-source-identifier">source identifier</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is">is</a> <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-source-identifier" id="ref-for-attribution-report-source-identifierâ ">source identifier</a></p>
       </ul>
      <li data-md>
       <p>If <var>matchingReports</var> is empty, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-removeâ¡">remove</a> <var>sourceToAttribute</var> from the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cacheâ¢">attribution source cache</a> and return.</p>
      <li data-md>
       <p>Set <var>matchingReports</var> to the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-sort-in-ascending-order" id="ref-for-list-sort-in-ascending-order">sorting</a> <var>matchingReports</var> in ascending order, with <var>a</var> being less than <var>b</var> if any of the following are true:</p>
       <ul>
        <li data-md>
         <p><var>a</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-priority" id="ref-for-attribution-report-trigger-priority">trigger priority</a> is less than <var>b</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-priority" id="ref-for-attribution-report-trigger-priorityâ ">trigger priority</a>.</p>
        <li data-md>
         <p><var>a</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-priority" id="ref-for-attribution-report-trigger-priorityâ¡">trigger priority</a> is equal to <var>b</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-priority" id="ref-for-attribution-report-trigger-priorityâ¢">trigger priority</a> and <var>a</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-time" id="ref-for-attribution-report-trigger-time">trigger time</a> is greater than <var>b</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-time" id="ref-for-attribution-report-trigger-timeâ ">trigger time</a>.</p>
       </ul>
      <li data-md>
       <p>Let <var>lowestPriorityReport</var> be the first item in <var>matchingReports</var>.</p>
      <li data-md>
       <p>If <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-priority" id="ref-for-attribution-report-trigger-priorityâ£">trigger priority</a> is less than or equal to <var>lowestPriorityReport</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-priority" id="ref-for-attribution-report-trigger-priorityâ¤">trigger priority</a>, return.</p>
      <li data-md>
       <p>Remove <var>lowestPriorityReport</var> from the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ£">attribution report cache</a>.</p>
      <li data-md>
       <p>Decrement <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-number-of-reports" id="ref-for-attribution-source-number-of-reportsâ¡">number of reports</a> value by 1.</p>
     </ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-removeâ¢">Remove</a> <var>sourceToAttribute</var> from <var>matchingSources</var>.</p>
    <li data-md>
     <p>For each <var>item</var> of <var>matchingSources</var>:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-removeâ£">Remove</a> <var>item</var> from the <a data-link-type="dfn" href="#attribution-source-cache" id="ref-for-attribution-source-cacheâ£">attribution source cache</a>.</p>
     </ol>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-sizeâ¢">size</a> of the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ¤">attribution report cache</a> is greater than or equal to the user
agentâs <a data-link-type="dfn" href="#max-report-cache-size" id="ref-for-max-report-cache-sizeâ ">max report cache size</a>, return.</p>
    <li data-md>
     <p>If <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-mode" id="ref-for-attribution-source-attribution-modeâ¥">attribution mode</a>[0] is "<code>truthfully</code>",
add <var>report</var> to the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ¥">attribution report cache</a>.</p>
    <li data-md>
     <p>Increment <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-number-of-reports" id="ref-for-attribution-source-number-of-reportsâ¢">number of reports</a> value by 1.</p>
    <li data-md>
     <p>If <var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-dedup-key" id="ref-for-attribution-trigger-dedup-keyâ£">dedup key</a> is not null, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">append</a> it to <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-dedup-keys" id="ref-for-attribution-source-dedup-keysâ ">dedup keys</a>.</p>
    <li data-md>
     <p>Let <var>rateLimitRecord</var> be a new <a data-link-type="dfn" href="#attribution-rate-limit-record" id="ref-for-attribution-rate-limit-recordâ ">attribution rate-limit record</a> with the items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-source-site" id="ref-for-attribution-rate-limit-record-source-siteâ¡">source site</a>
      <dd data-md>
       <p>The result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site" id="ref-for-obtain-a-siteâ¢">obtaining a site</a> from <var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-originâ¡">source origin</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-attribution-destination" id="ref-for-attribution-rate-limit-record-attribution-destinationâ¡">attribution destination</a>
      <dd data-md>
       <p><var>attributionDestination</var></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-source-type" id="ref-for-attribution-rate-limit-record-source-typeâ¡">source type</a>
      <dd data-md>
       <p><var>sourceToAttribute</var>âs <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ¥">source type</a></p>
      <dt data-md><a data-link-type="dfn" href="#attribution-rate-limit-record-trigger-time" id="ref-for-attribution-rate-limit-record-trigger-timeâ ">trigger time</a>
      <dd data-md>
       <p><var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-timeâ¢">trigger time</a></p>
     </dl>
    <li data-md>
     <p>Add <var>rateLimitRecord</var> to the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cacheâ ">attribution rate-limit cache</a>.</p>
    <li data-md>
     <p>Remove all entries from the <a data-link-type="dfn" href="#attribution-rate-limit-cache" id="ref-for-attribution-rate-limit-cacheâ¡">attribution rate-limit cache</a> whose <a data-link-type="dfn" href="#attribution-rate-limit-record-trigger-time" id="ref-for-attribution-rate-limit-record-trigger-timeâ¡">trigger time</a> is at least <a data-link-type="dfn" href="#attribution-rate-limit-window" id="ref-for-attribution-rate-limit-windowâ¡">attribution rate-limit window</a> before the current time.</p>
   </ol>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-reports-per-attribution-destination">Max reports per attribution destination</dfn> is a vendor-specific integer which controls how
many <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ£">attribution reports</a> can be in the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ¦">attribution report cache</a> for an <a data-link-type="dfn" href="#attribution-report-attribution-destination" id="ref-for-attribution-report-attribution-destinationâ ">attribution destination</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-reports-per-source">Max reports per source</dfn> is a vendor-specific integer which controls how many <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ¤">attribution reports</a> can be created for an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¡âª">attribution source</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max-report-cache-size">Max report cache size</dfn> is a vendor-specific integer which controls how many <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ¥">attribution reports</a> can be in the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ§">attribution report cache</a>.</p>
   <p class="note" role="note"><span>Note:</span> This parameter represents a privacy/utility tradeoff. Lower values mean that less trigger-side data
can be associated with a source event id. Larger values allow for more attribution triggers to be reported.</p>
   <h3 class="heading settled algorithm" data-algorithm="Establishing report delivery time" data-level="10.5" id="delivery-time"><span class="secno">10.5. </span><span class="content">Establishing report delivery time</span><a class="self-link" href="#delivery-time"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-report-delivery-time">obtain a report delivery time</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¡â ">attribution source</a> <var>source</var> and a <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-timeâ£">trigger time</a> <var>triggerTime</var>, perform the following steps. They
return a point in time.</p>
   <ol>
    <li data-md>
     <p>If <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ¦">source type</a> is "<code>event</code>", return <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry-time" id="ref-for-attribution-source-expiry-timeâ¡">expiry time</a> + 1 hour.</p>
    <li data-md>
     <p>Let <var>timeToTrigger</var> be the difference between <var>triggerTime</var> and <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-timeâ¤">source time</a>.</p>
     <p class="note" role="note"><span>Note:</span> <var>timeToTrigger</var> is less than <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiryâ¢">expiry</a> because it is not normally possible to
convert an expired attribution source.</p>
    <li data-md>
     <p>If:</p>
     <dl class="switch">
      <dt><var>timeToTrigger</var> &lt;= (2 days - 1 hour)
      <dd>return <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-timeâ¥">source time</a> + 2 days.
      <dt>
        <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiryâ£">expiry</a> > (2 days - 1 hour) 
       <ul>
        <li data-md>
         <p>and <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiryâ¤">expiry</a> &lt; (7 days - 1 hour)</p>
        <li data-md>
         <p>and <var>timeToTrigger</var> &lt;= <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry" id="ref-for-attribution-source-expiryâ¥">expiry</a></p>
       </ul>
      <dd>return <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry-time" id="ref-for-attribution-source-expiry-timeâ¢">expiry time</a> + 1 hour.
      <dt><var>timeToTrigger</var> &lt;= (7 days - 1 hour)
      <dd>return <a data-link-type="dfn" href="#attribution-source-source-time" id="ref-for-attribution-source-source-timeâ¦">source time</a> + 7 days.
      <dt>Otherwise
      <dd>return <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-expiry-time" id="ref-for-attribution-source-expiry-timeâ£">expiry time</a> + 1 hour.
     </dl>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Obtaining a report" data-level="10.6" id="obtaining-a-report"><span class="secno">10.6. </span><span class="content">Obtaining a report</span><a class="self-link" href="#obtaining-a-report"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-a-report">obtain a report</dfn> given an <a data-link-type="dfn" href="#attribution-source" id="ref-for-attribution-sourceâ¡â¡">attribution source</a> <var>source</var> and an <a data-link-type="dfn" href="#attribution-trigger" id="ref-for-attribution-triggerâ¥">attribution trigger</a> <var>trigger</var>:</p>
   <ol>
    <li data-md>
     <p>Let <var>triggerData</var> be <var>trigger</var>âs <a data-link-type="dfn">trigger data</a>.</p>
    <li data-md>
     <p>If <var>source</var>âs <a data-link-type="dfn" href="#attribution-source-source-type" id="ref-for-attribution-source-source-typeâ§">source type</a> is "<code>event</code>", set <var>triggerData</var> to <var>trigger</var>âs <a data-link-type="dfn">event source trigger data</a>.</p>
    <li data-md>
     <p>Let <var>report</var> be a new <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ¦">attribution report</a> struct whose items are:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-event-id" id="ref-for-attribution-report-event-id">event id</a>
      <dd data-md>
       <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-event-id" id="ref-for-attribution-source-event-idâ¢">event id</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-trigger-data" id="ref-for-attribution-report-trigger-data">trigger data</a>
      <dd data-md>
       <p><var>triggerData</var>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-randomized-trigger-rate" id="ref-for-attribution-report-randomized-trigger-rate">randomized trigger rate</a>
      <dd data-md>
       <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-randomized-trigger-rate" id="ref-for-attribution-source-randomized-trigger-rateâ¡">randomized trigger rate</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-reporting-endpoint" id="ref-for-attribution-report-reporting-endpoint">reporting endpoint</a>
      <dd data-md>
       <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpointâ¥">reporting endpoint</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-attribution-destination" id="ref-for-attribution-report-attribution-destinationâ¡">attribution destination</a>
      <dd data-md>
       <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ¨">attribution destination</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-report-time" id="ref-for-attribution-report-report-timeâ¡">reporting time</a>
      <dd data-md>
       <p>The result of running <a data-link-type="dfn" href="#obtain-a-report-delivery-time" id="ref-for-obtain-a-report-delivery-time">obtain a report delivery time</a> with <var>source</var> and <var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-timeâ¤">trigger time</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-trigger-priority" id="ref-for-attribution-report-trigger-priorityâ¥">trigger priority</a>
      <dd data-md>
       <p><var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-priority" id="ref-for-attribution-trigger-priorityâ¡">priority</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-trigger-time" id="ref-for-attribution-report-trigger-timeâ¡">trigger time</a>
      <dd data-md>
       <p><var>trigger</var>âs <a data-link-type="dfn" href="#attribution-trigger-trigger-time" id="ref-for-attribution-trigger-trigger-timeâ¥">trigger time</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-source-identifier" id="ref-for-attribution-report-source-identifierâ¡">source identifier</a>
      <dd data-md>
       <p><var>source</var>âs <a data-link-type="dfn" href="#attribution-source-source-identifier" id="ref-for-attribution-source-source-identifierâ¡">source identifier</a>.</p>
      <dt data-md><a data-link-type="dfn" href="#attribution-report-report-id" id="ref-for-attribution-report-report-id">report id</a>
      <dd data-md>
       <p>The result of <a data-link-type="dfn" href="https://wicg.github.io/uuid/#dfn-generate-a-random-uuid" id="ref-for-dfn-generate-a-random-uuid">generating a random UUID</a>.</p>
     </dl>
    <li data-md>
     <p>Return <var>report</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="11" id="report-delivery"><span class="secno">11. </span><span class="content">Report delivery</span><a class="self-link" href="#report-delivery"></a></h2>
   <p>The user agent MUST periodically <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">iterate</a> over its <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ¨">attribution report cache</a> and run <a data-link-type="dfn" href="#queue-a-report-for-delivery" id="ref-for-queue-a-report-for-delivery">queue a report for delivery</a> on each item.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="queue-a-report-for-delivery">queue a report for delivery</dfn> given an <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ§">attribution report</a> <var>report</var>, run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>:</p>
   <ol>
    <li data-md>
     <p>If <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-delivered" id="ref-for-attribution-report-delivered">delivered</a> value is true, return.</p>
    <li data-md>
     <p>Set <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-delivered" id="ref-for-attribution-report-deliveredâ ">delivered</a> value to true.</p>
    <li data-md>
     <p>If <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-report-time" id="ref-for-attribution-report-report-timeâ¢">report time</a> is less than the current time, add an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> random amount to report time.</p>
     <p class="note" role="note"><span>Note:</span> On startup, it is possible the user agent will need to send many reports whose report times passed while the browser was
 closed. Adding random delay prevents temporal joining of reports from different <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-originâ¢">source origin</a>s.</p>
    <li data-md>
     <p>Wait until <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-report-time" id="ref-for-attribution-report-report-timeâ£">report time</a> is the current time.</p>
    <li data-md>
     <p>Optionally, wait a further <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-definedâ ">implementation-defined</a> length of time.</p>
     <p class="note" role="note"><span>Note:</span> This is intended to allow user agents to optimize device resource usage.</p>
    <li data-md>
     <p>Run <a data-link-type="dfn" href="#attempt-to-deliver-a-report" id="ref-for-attempt-to-deliver-a-report">attempt to deliver a report</a> with <var>report</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="11.1" id="serialize-integer"><span class="secno">11.1. </span><span class="content">Serialize an integer</span><a class="self-link" href="#serialize-integer"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="serialize-an-integer">serialize an integer</dfn>, represent it as a string of the shortest possible decimal number.</p>
   <p class="issue" id="issue-ccb90c6c"><a class="self-link" href="#issue-ccb90c6c"></a> This would ideally be replaced by a more descriptive algorithm in Infra. See <a href="https://github.com/whatwg/infra/issues/201">infra/201</a></p>
   <h3 class="heading settled" data-level="11.2" id="serialize-report-body"><span class="secno">11.2. </span><span class="content">Serialize attribution report body</span><a class="self-link" href="#serialize-report-body"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="serialize-an-attribution-report">serialize an <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ¨">attribution report</a></dfn> <var>report</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>destination</var> be <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-attribution-destination" id="ref-for-attribution-report-attribution-destinationâ¢">attribution destination</a>.</p>
    <li data-md>
     <p class="assertion">Assert: <var>destination</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaqueâ¤">opaque origin</a>.</p>
    <li data-md>
     <p>Let <var>data</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">map</a> of the following key/value pairs:</p>
     <dl>
      <dt data-md>"<code>attribution_destination</code>"
      <dd data-md>
       <p><var>destination</var>, <a href="https://html.spec.whatwg.org/multipage/origin.html#serialization-of-a-site">serialized</a></p>
      <dt data-md>"<code>randomized_trigger_rate</code>"
      <dd data-md>
       <p><var>report</var>âs <a data-link-type="dfn" href="#attribution-report-randomized-trigger-rate" id="ref-for-attribution-report-randomized-trigger-rateâ ">randomized trigger rate</a></p>
      <dt data-md>"<code>source_type</code>"
      <dd data-md>
       <p><var>report</var>âs <a data-link-type="dfn" href="#attribution-report-source-type" id="ref-for-attribution-report-source-type">source type</a></p>
      <dt data-md>"<code>source_event_id</code>"
      <dd data-md>
       <p><var>report</var>âs <a data-link-type="dfn" href="#attribution-report-event-id" id="ref-for-attribution-report-event-idâ ">event id</a>, <a data-link-type="dfn" href="#serialize-an-integer" id="ref-for-serialize-an-integer">serialized</a></p>
      <dt data-md>"<code>trigger_data</code>"
      <dd data-md>
       <p><var>report</var>âs <a data-link-type="dfn" href="#attribution-report-trigger-data" id="ref-for-attribution-report-trigger-dataâ ">trigger data</a>, <a data-link-type="dfn" href="#serialize-an-integer" id="ref-for-serialize-an-integerâ ">serialized</a></p>
      <dt data-md>"<code>report_id</code>"
      <dd data-md>
       <p><var>report</var>âs <a data-link-type="dfn" href="#attribution-report-report-id" id="ref-for-attribution-report-report-idâ ">report id</a></p>
     </dl>
    <li data-md>
     <p>Return the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">byte sequence</a> resulting from executing <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes" id="ref-for-serialize-an-infra-value-to-json-bytes">serialize an infra value to JSON bytes</a> on <var>data</var>.</p>
   </ol>
   <p class="note" role="note"><span>Note:</span> The inclusion of "<code>report_id</code>" in the report body is intended to allow the report recipient
to perform deduplication and prevent double counting, in the event that the user agent retries
reports on failure. To prevent the report recipient from learning additional information about
whether a user is online, retries should be limited in number and subject to random delays.</p>
   <h3 class="heading settled" data-level="11.3" id="get-report-url"><span class="secno">11.3. </span><span class="content">Get report request URL</span><a class="self-link" href="#get-report-url"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generate-a-report-url">generate a report URL</dfn> for a given <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ âª">attribution report</a> <var>report</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>reportUrl</var> be a new <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-urlâ¡">URL record</a>.</p>
    <li data-md>
     <p>Let <var>reportingOrigin</var> be <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-reporting-endpoint" id="ref-for-attribution-report-reporting-endpointâ ">reporting endpoint</a>.</p>
    <li data-md>
     <p class="assertion">Assert: <var>reportingOrigin</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaqueâ¥">opaque origin</a>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> to <var>reportingOrigin</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme" id="ref-for-concept-origin-scheme">scheme</a>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host" id="ref-for-concept-url-host">host</a> to <var>reportingOrigin</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host" id="ref-for-concept-origin-host">host</a>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-port" id="ref-for-concept-url-port">port</a> to <var>reportingOrigin</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-port" id="ref-for-concept-origin-port">port</a>.</p>
    <li data-md>
     <p>Set <var>reportUrl</var>âs <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-pathâ ">path</a> to Â«"<code>.well-known</code>", "<code>attribution-reporting</code>", "<code>report-attribution</code>"Â».</p>
    <li data-md>
     <p>Return <var>reportUrl</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="11.4" id="issue-report-request"><span class="secno">11.4. </span><span class="content">Issuing a report request</span><a class="self-link" href="#issue-report-request"></a></h3>
   <p>This algorithm constructs a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-requestâ ">request</a> and attempts to deliver it to <var>report</var>âs <a data-link-type="dfn" href="#attribution-report-reporting-endpoint" id="ref-for-attribution-report-reporting-endpointâ¡">reporting endpoint</a>.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attempt-to-deliver-a-report">attempt to deliver a report</dfn> given an <a data-link-type="dfn" href="#attribution-report" id="ref-for-attribution-reportâ â ">attribution report</a> <var>report</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>body</var> be the result of executing <a data-link-type="dfn" href="#serialize-an-attribution-report" id="ref-for-serialize-an-attribution-report">serialize an attribution report</a> on <var>report</var>.</p>
    <li data-md>
     <p>Let <var>url</var> be the result of executing <a data-link-type="dfn" href="#generate-a-report-url" id="ref-for-generate-a-report-url">generate a report URL</a> on <var>report</var>.</p>
    <li data-md>
     <p>Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-requestâ¡">request</a> with the following properties:</p>
     <dl>
      <dt data-md><code>method</code>
      <dd data-md>
       <p>"<code>POST</code>"</p>
      <dt data-md><code>url</code>
      <dd data-md>
       <p><var>url</var></p>
      <dt data-md><code>header list</code>
      <dd data-md>
       <p>A new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a> containing a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header">header</a> named
"<code>Content-Type</code>" whose value is "<code>application/json</code>"</p>
      <dt data-md><code>body</code>
      <dd data-md>
       <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body" id="ref-for-concept-body">body</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-source" id="ref-for-concept-body-source">source</a> is <var>body</var>.</p>
      <dt data-md><code>referrer</code>
      <dd data-md>
       <p>"<code>no-referrer</code>"</p>
      <dt data-md><code>client</code>
      <dd data-md>
       <p><code>null</code></p>
      <dt data-md><code>window</code>
      <dd data-md>
       <p>"<code>no-window</code>"</p>
      <dt data-md><code>service-workers mode</code>
      <dd data-md>
       <p>"<code>none</code>"</p>
      <dt data-md><code>initiator</code>
      <dd data-md>
       <p>""</p>
      <dt data-md><code>mode</code>
      <dd data-md>
       <p>"<code>cors</code>"</p>
      <dt data-md><code>unsafe-request</code> flag
      <dd data-md>
       <p>set</p>
      <dt data-md><code>credentials mode</code>
      <dd data-md>
       <p>"<code>omit</code>"</p>
      <dt data-md><code>cache mode</code>
      <dd data-md>
       <p>"<code>no-store</code>"</p>
     </dl>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-taskâ¢">Queue a task</a> to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">fetch</a> <var>request</var> with <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#process-response" id="ref-for-process-response">processResponse</a> being these steps:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-taskâ£">Queue a task</a> to remove <var>report</var> from the <a data-link-type="dfn" href="#attribution-report-cache" id="ref-for-attribution-report-cacheâ âª">attribution report cache</a>.</p>
     </ol>
   </ol>
   <p class="issue" id="issue-c8706ee1"><a class="self-link" href="#issue-c8706ee1"></a> This fetch should use a network partition key for an opaque origin. <a href="https://github.com/WICG/conversion-measurement-api/issues/220">&lt;https://github.com/WICG/conversion-measurement-api/issues/220></a></p>
   <p>A user agent MAY retry this algorithm in the event that there was an error.</p>
   <h2 class="heading settled" data-level="12" id="security-considerations"><span class="secno">12. </span><span class="content">Security considerations</span><a class="self-link" href="#security-considerations"></a></h2>
    TODO 
   <h2 class="heading settled" data-level="13" id="privacy-considerations"><span class="secno">13. </span><span class="content">Privacy consideration</span><a class="self-link" href="#privacy-considerations"></a></h2>
    TODO 
   <h3 class="heading settled" data-level="13.1" id="clearing-attribution-storage"><span class="secno">13.1. </span><span class="content">Clearing attribution storage</span><a class="self-link" href="#clearing-attribution-storage"></a></h3>
   <p>A user agentâs <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-cachesâ ">attribution caches</a> contain data about a userâs web activity. When a user agent clears an originâs storage,
it MUST also remove entries in the <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-cachesâ¡">attribution caches</a> whose <a data-link-type="dfn" href="#attribution-source-source-origin" id="ref-for-attribution-source-source-originâ£">source origin</a>, <a data-link-type="dfn" href="#attribution-source-attribution-destination" id="ref-for-attribution-source-attribution-destinationâ âª">attribution destination</a>, <a data-link-type="dfn" href="#attribution-source-reporting-endpoint" id="ref-for-attribution-source-reporting-endpointâ¦">reporting endpoint</a>, <a data-link-type="dfn" href="#attribution-report-attribution-destination" id="ref-for-attribution-report-attribution-destinationâ£">attribution destination</a>, or <a data-link-type="dfn" href="#attribution-report-reporting-endpoint" id="ref-for-attribution-report-reporting-endpointâ¢">reporting endpoint</a> is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-originâ¡">same</a> as the cleared origin.</p>
   <p>A user agent MAY clear <a data-link-type="dfn" href="#attribution-caches" id="ref-for-attribution-cachesâ¢">attribution cache</a> entries at other times. For example, when a user agent clears
an origin from a userâs browsing history.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words âMUSTâ, âMUST NOTâ, âREQUIREDâ, âSHALLâ, âSHALL NOTâ, âSHOULDâ, âSHOULD NOTâ, âRECOMMENDEDâ, âMAYâ, and âOPTIONALâ
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words âfor exampleâ
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word âNoteâ
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note. </p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">â</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">â</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">â</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Donât scroll to compensate for the ToC if weâre above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I donât know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldnât exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isnât standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we donât have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While weâre at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Canât find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#attempt-to-deliver-a-report">attempt to deliver a report</a><span>, in Â§11.4</span>
   <li><a href="#attribution-caches">attribution caches</a><span>, in Â§7</span>
   <li>
    attribution destination
    <ul>
     <li><a href="#attribution-rate-limit-record-attribution-destination">dfn for attribution rate-limit record</a><span>, in Â§6.5</span>
     <li><a href="#attribution-report-attribution-destination">dfn for attribution report</a><span>, in Â§6.4</span>
     <li><a href="#attribution-source-attribution-destination">dfn for attribution source</a><span>, in Â§6.2</span>
     <li><a href="#attribution-trigger-attribution-destination">dfn for attribution trigger</a><span>, in Â§6.3</span>
    </ul>
   <li>
    attributionDestination
    <ul>
     <li><a href="#dom-htmlanchorelement-attributiondestination">attribute for HTMLAnchorElement</a><span>, in Â§2.2</span>
     <li><a href="#dom-attributionsourceparams-attributiondestination">dict-member for AttributionSourceParams</a><span>, in Â§4</span>
    </ul>
   <li><a href="#element-attrdef-a-attributiondestination">attributiondestination</a><span>, in Â§2.2</span>
   <li>
    attributionExpiry
    <ul>
     <li><a href="#dom-htmlanchorelement-attributionexpiry">attribute for HTMLAnchorElement</a><span>, in Â§2.2</span>
     <li><a href="#dom-attributionsourceparams-attributionexpiry">dict-member for AttributionSourceParams</a><span>, in Â§4</span>
    </ul>
   <li><a href="#element-attrdef-a-attributionexpiry">attributionexpiry</a><span>, in Â§2.2</span>
   <li><a href="#attribution-mode">Attribution mode</a><span>, in Â§6</span>
   <li><a href="#attribution-source-attribution-mode">attribution mode</a><span>, in Â§6.2</span>
   <li><a href="#attribution-rate-limit-cache">attribution rate-limit cache</a><span>, in Â§7</span>
   <li><a href="#attribution-rate-limit-record">Attribution rate-limit record</a><span>, in Â§6.4</span>
   <li><a href="#attribution-rate-limit-window">Attribution rate-limit window</a><span>, in Â§10.3</span>
   <li><a href="#attribution-report">Attribution report</a><span>, in Â§6.3</span>
   <li><a href="#attribution-report-cache">attribution report cache</a><span>, in Â§7</span>
   <li><a href="#attribution-reporting">attribution-reporting</a><span>, in Â§5</span>
   <li><a href="#attributionreporting">AttributionReporting</a><span>, in Â§4</span>
   <li><a href="#dom-window-attributionreporting">attributionReporting</a><span>, in Â§4</span>
   <li>
    attributionReportTo
    <ul>
     <li><a href="#dom-htmlanchorelement-attributionreportto">attribute for HTMLAnchorElement</a><span>, in Â§2.2</span>
     <li><a href="#dom-attributionsourceparams-attributionreportto">dict-member for AttributionSourceParams</a><span>, in Â§4</span>
    </ul>
   <li><a href="#element-attrdef-a-attributionreportto">attributionreportto</a><span>, in Â§2.2</span>
   <li><a href="#attribution-source">Attribution source</a><span>, in Â§6.1</span>
   <li><a href="#navigation-params-attribution-source">attribution source</a><span>, in Â§2.3.1</span>
   <li><a href="#attribution-source-cache">attribution source cache</a><span>, in Â§7</span>
   <li>
    attributionSourceEventId
    <ul>
     <li><a href="#dom-htmlanchorelement-attributionsourceeventid">attribute for HTMLAnchorElement</a><span>, in Â§2.2</span>
     <li><a href="#dom-attributionsourceparams-attributionsourceeventid">dict-member for AttributionSourceParams</a><span>, in Â§4</span>
    </ul>
   <li><a href="#element-attrdef-a-attributionsourceeventid">attributionsourceeventid</a><span>, in Â§2.2</span>
   <li><a href="#dictdef-attributionsourceparams">AttributionSourceParams</a><span>, in Â§4</span>
   <li>
    attributionSourcePriority
    <ul>
     <li><a href="#dom-htmlanchorelement-attributionsourcepriority">attribute for HTMLAnchorElement</a><span>, in Â§2.2</span>
     <li><a href="#dom-attributionsourceparams-attributionsourcepriority">dict-member for AttributionSourceParams</a><span>, in Â§4</span>
    </ul>
   <li><a href="#element-attrdef-a-attributionsourcepriority">attributionsourcepriority</a><span>, in Â§2.2</span>
   <li><a href="#attribution-trigger">Attribution trigger</a><span>, in Â§6.2</span>
   <li><a href="#attribution-trigger-dedup-key">dedup key</a><span>, in Â§6.3</span>
   <li><a href="#attribution-source-dedup-keys">dedup keys</a><span>, in Â§6.2</span>
   <li><a href="#attribution-report-delivered">delivered</a><span>, in Â§6.4</span>
   <li>
    event id
    <ul>
     <li><a href="#attribution-report-event-id">dfn for attribution report</a><span>, in Â§6.4</span>
     <li><a href="#attribution-source-event-id">dfn for attribution source</a><span>, in Â§6.2</span>
    </ul>
   <li><a href="#attribution-trigger-event-source-trigger-data">event-source trigger data</a><span>, in Â§6.3</span>
   <li><a href="#event-source-trigger-data-cardinality">Event-source trigger data cardinality</a><span>, in Â§10.1</span>
   <li><a href="#attribution-source-expiry">expiry</a><span>, in Â§6.2</span>
   <li><a href="#attribution-source-expiry-time">expiry time</a><span>, in Â§9.1</span>
   <li><a href="#generate-a-report-url">generate a report URL</a><span>, in Â§11.3</span>
   <li><a href="#limited-to-only-non-negative-numbers">limited to only non-negative numbers</a><span>, in Â§2.1</span>
   <li><a href="#max-attributions-per-rate-limit-window">Max attributions per rate-limit window</a><span>, in Â§10.3</span>
   <li><a href="#max-event-id-value">Max event id value</a><span>, in Â§9.8</span>
   <li><a href="#max-report-cache-size">Max report cache size</a><span>, in Â§10.4</span>
   <li><a href="#max-reports-per-attribution-destination">Max reports per attribution destination</a><span>, in Â§10.4</span>
   <li><a href="#max-reports-per-source">Max reports per source</a><span>, in Â§10.4</span>
   <li><a href="#max-source-cache-size">Max source cache size</a><span>, in Â§9.9</span>
   <li><a href="#maybe-process-a-navigation-attribution-source">maybe process a navigation attribution source</a><span>, in Â§9.9</span>
   <li><a href="#attribution-trigger-navigation-source-trigger-data">navigation-source trigger data</a><span>, in Â§6.3</span>
   <li><a href="#attribution-source-number-of-reports">number of reports</a><span>, in Â§6.2</span>
   <li><a href="#obtain-an-attribution-source-from-an-anchor">obtain an attribution source from an anchor</a><span>, in Â§9.5</span>
   <li><a href="#obtain-an-attribution-source-from-params">obtain an attribution source from params</a><span>, in Â§9.8</span>
   <li><a href="#obtain-an-attribution-trigger">obtain an attribution trigger</a><span>, in Â§10.1</span>
   <li><a href="#obtain-an-event-attribution-source-from-an-anchor">obtain an event attribution source from an anchor</a><span>, in Â§9.6</span>
   <li><a href="#obtain-an-event-attribution-source-from-a-source">obtain an event attribution source from a source</a><span>, in Â§9.7</span>
   <li><a href="#obtain-a-random-attribution-mode">obtain a random attribution mode</a><span>, in Â§9.4</span>
   <li><a href="#obtain-a-randomized-response">obtain a randomized response</a><span>, in Â§8.1</span>
   <li><a href="#obtain-a-report">obtain a report</a><span>, in Â§10.6</span>
   <li><a href="#obtain-a-report-delivery-time">obtain a report delivery time</a><span>, in Â§10.5</span>
   <li><a href="#parse-an-attribution-destination">parse an attribution destination</a><span>, in Â§9.3</span>
   <li><a href="#parse-attribution-data">parse attribution data</a><span>, in Â§9.2</span>
   <li>
    priority
    <ul>
     <li><a href="#attribution-source-priority">dfn for attribution source</a><span>, in Â§6.2</span>
     <li><a href="#attribution-trigger-priority">dfn for attribution trigger</a><span>, in Â§6.3</span>
    </ul>
   <li><a href="#process-an-attribution-source">process an attribution source</a><span>, in Â§9.9</span>
   <li><a href="#queue-a-report-for-delivery">queue a report for delivery</a><span>, in Â§11</span>
   <li><a href="#randomized-event-source-trigger-rate">Randomized event-source trigger rate</a><span>, in Â§9.7</span>
   <li>
    randomized trigger rate
    <ul>
     <li><a href="#attribution-report-randomized-trigger-rate">dfn for attribution report</a><span>, in Â§6.4</span>
     <li><a href="#attribution-source-randomized-trigger-rate">dfn for attribution source</a><span>, in Â§6.2</span>
    </ul>
   <li><a href="#dom-htmlanchorelement-registerattributionsource">registerAttributionSource</a><span>, in Â§2.2</span>
   <li><a href="#element-attrdef-a-registerattributionsource">registerattributionsource</a><span>, in Â§2.2</span>
   <li><a href="#dom-attributionreporting-registerattributionsource">registerAttributionSource(params)</a><span>, in Â§4</span>
   <li><a href="#attribution-report-report-id">report id</a><span>, in Â§6.4</span>
   <li>
    reporting endpoint
    <ul>
     <li><a href="#attribution-report-reporting-endpoint">dfn for attribution report</a><span>, in Â§6.4</span>
     <li><a href="#attribution-source-reporting-endpoint">dfn for attribution source</a><span>, in Â§6.2</span>
     <li><a href="#attribution-trigger-reporting-endpoint">dfn for attribution trigger</a><span>, in Â§6.3</span>
    </ul>
   <li><a href="#attribution-report-report-time">report time</a><span>, in Â§6.4</span>
   <li><a href="#serialize-an-attribution-report">serialize an attribution report</a><span>, in Â§11.2</span>
   <li><a href="#serialize-an-integer">serialize an integer</a><span>, in Â§11.1</span>
   <li><a href="#should-rate-limit-attribution">Should attribution be blocked by rate limit</a><span>, in Â§10.2</span>
   <li><a href="#should-block-response">Should internalResponse to request be blocked as attribution trigger</a><span>, in Â§10.1</span>
   <li>
    source identifier
    <ul>
     <li><a href="#attribution-report-source-identifier">dfn for attribution report</a><span>, in Â§6.4</span>
     <li><a href="#attribution-source-source-identifier">dfn for attribution source</a><span>, in Â§6.2</span>
    </ul>
   <li><a href="#attribution-source-source-origin">source origin</a><span>, in Â§6.2</span>
   <li><a href="#attribution-rate-limit-record-source-site">source site</a><span>, in Â§6.5</span>
   <li><a href="#attribution-source-source-time">source time</a><span>, in Â§6.2</span>
   <li>
    source type
    <ul>
     <li><a href="#attribution-rate-limit-record-source-type">dfn for attribution rate-limit record</a><span>, in Â§6.5</span>
     <li><a href="#attribution-report-source-type">dfn for attribution report</a><span>, in Â§6.4</span>
     <li><a href="#attribution-source-source-type">dfn for attribution source</a><span>, in Â§6.2</span>
    </ul>
   <li><a href="#trigger-attribution">trigger attribution</a><span>, in Â§10.4</span>
   <li><a href="#attribution-report-trigger-data">trigger data</a><span>, in Â§6.4</span>
   <li><a href="#trigger-data-cardinality">Trigger data cardinality</a><span>, in Â§10.1</span>
   <li><a href="#attribution-report-trigger-priority">trigger priority</a><span>, in Â§6.4</span>
   <li>
    trigger time
    <ul>
     <li><a href="#attribution-rate-limit-record-trigger-time">dfn for attribution rate-limit record</a><span>, in Â§6.5</span>
     <li><a href="#attribution-report-trigger-time">dfn for attribution report</a><span>, in Â§6.4</span>
     <li><a href="#attribution-trigger-trigger-time">dfn for attribution trigger</a><span>, in Â§6.3</span>
    </ul>
  </ul>
  <aside class="dfn-panel" data-for="term-for-concept-body">
   <a href="https://fetch.spec.whatwg.org/#concept-body">https://fetch.spec.whatwg.org/#concept-body</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-body">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-current-url">
   <a href="https://fetch.spec.whatwg.org/#concept-request-current-url">https://fetch.spec.whatwg.org/#concept-request-current-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-current-url">10.2. Should internalResponse to request be blocked as attribution trigger</a> <a href="#ref-for-concept-request-current-urlâ ">(2)</a> <a href="#ref-for-concept-request-current-urlâ¡">(3)</a> <a href="#ref-for-concept-request-current-urlâ¢">(4)</a> <a href="#ref-for-concept-request-current-urlâ£">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-fetch">
   <a href="https://fetch.spec.whatwg.org/#concept-fetch">https://fetch.spec.whatwg.org/#concept-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-fetch">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header">
   <a href="https://fetch.spec.whatwg.org/#concept-header">https://fetch.spec.whatwg.org/#concept-header</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header-list">
   <a href="https://fetch.spec.whatwg.org/#concept-header-list">https://fetch.spec.whatwg.org/#concept-header-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header-list">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-main-fetch">
   <a href="https://fetch.spec.whatwg.org/#concept-main-fetch">https://fetch.spec.whatwg.org/#concept-main-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-main-fetch">3. Fetch monkeypatches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-response">
   <a href="https://fetch.spec.whatwg.org/#process-response">https://fetch.spec.whatwg.org/#process-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-response">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-redirect-count">
   <a href="https://fetch.spec.whatwg.org/#concept-request-redirect-count">https://fetch.spec.whatwg.org/#concept-request-redirect-count</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-redirect-count">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request">
   <a href="https://fetch.spec.whatwg.org/#concept-request">https://fetch.spec.whatwg.org/#concept-request</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request">10.2. Should internalResponse to request be blocked as attribution trigger</a>
    <li><a href="#ref-for-concept-requestâ ">11.4. Issuing a report request</a> <a href="#ref-for-concept-requestâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-body-source">
   <a href="https://fetch.spec.whatwg.org/#concept-body-source">https://fetch.spec.whatwg.org/#concept-body-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-body-source">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-url-list">
   <a href="https://fetch.spec.whatwg.org/#concept-request-url-list">https://fetch.spec.whatwg.org/#concept-request-url-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-url-list">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-window">
   <a href="https://fetch.spec.whatwg.org/#concept-request-window">https://fetch.spec.whatwg.org/#concept-request-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-window">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-cereactions">
   <a href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cereactions">2.2. &lt;a> element</a> <a href="#ref-for-cereactionsâ ">(2)</a> <a href="#ref-for-cereactionsâ¡">(3)</a> <a href="#ref-for-cereactionsâ¢">(4)</a> <a href="#ref-for-cereactionsâ£">(5)</a> <a href="#ref-for-cereactionsâ¤">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlanchorelement">
   <a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement">https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlanchorelement">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window">https://html.spec.whatwg.org/multipage/window-object.html#window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-a-element">
   <a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element">https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-a-element">1.1. Overview</a> <a href="#ref-for-the-a-elementâ ">(2)</a> <a href="#ref-for-the-a-elementâ¡">(3)</a> <a href="#ref-for-the-a-elementâ¢">(4)</a>
    <li><a href="#ref-for-the-a-elementâ£">2.2. &lt;a> element</a> <a href="#ref-for-the-a-elementâ¤">(2)</a> <a href="#ref-for-the-a-elementâ¥">(3)</a>
    <li><a href="#ref-for-the-a-elementâ¦">2.4. Follow the hyperlink</a> <a href="#ref-for-the-a-elementâ§">(2)</a>
    <li><a href="#ref-for-the-a-elementâ¨">9.5. Obtaining an attribution source from an a element</a>
    <li><a href="#ref-for-the-a-elementâ âª">9.6. Obtaining an event attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-allowed-to-use">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-allowed-to-use">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-allowed-to-useâ ">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-document-window">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window">https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-window">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-concept-document-windowâ ">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-context">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-element-attributes">
   <a href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes">https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-element-attributes">2.1.  long long reflection </a>
    <li><a href="#ref-for-concept-element-attributesâ ">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-initialise-the-document-object">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object">https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-initialise-the-document-object">2.3.4. Document creation</a> <a href="#ref-for-initialise-the-document-objectâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-element-dom">
   <a href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-dom">https://html.spec.whatwg.org/multipage/dom.html#concept-element-dom</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-element-dom">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-settings-object">7. Storage</a>
    <li><a href="#ref-for-environment-settings-objectâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-environment-settings-objectâ¡">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-environment-settings-objectâ¢">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-following-hyperlinks-2">
   <a href="https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2">https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-following-hyperlinks-2">2.2. &lt;a> element</a>
    <li><a href="#ref-for-following-hyperlinks-2â ">2.4. Follow the hyperlink</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-host">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-host">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-in-parallel">
   <a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">11. Report delivery</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigate">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigate">2.3.2. Navigate algorithm</a> <a href="#ref-for-navigateâ ">(2)</a>
    <li><a href="#ref-for-navigateâ¡">2.4. Follow the hyperlink</a> <a href="#ref-for-navigateâ¢">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params">2.3.1. Navigation Params</a>
    <li><a href="#ref-for-navigation-paramsâ ">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-obtain-a-site">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site">https://html.spec.whatwg.org/multipage/origin.html#obtain-a-site</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-site">9.3. Parsing an attribution destination</a>
    <li><a href="#ref-for-obtain-a-siteâ ">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-obtain-a-siteâ¡">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-obtain-a-siteâ¢">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-opaque">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-opaque">9.3. Parsing an attribution destination</a>
    <li><a href="#ref-for-concept-origin-opaqueâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-concept-origin-opaqueâ¡">(2)</a>
    <li><a href="#ref-for-concept-origin-opaqueâ¢">10.2. Should internalResponse to request be blocked as attribution trigger</a> <a href="#ref-for-concept-origin-opaqueâ£">(2)</a>
    <li><a href="#ref-for-concept-origin-opaqueâ¤">11.2. Serialize attribution report body</a>
    <li><a href="#ref-for-concept-origin-opaqueâ¥">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-origin">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-port">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-port">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-port</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-port">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-a-navigate-fetch">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch">https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-a-navigate-fetch">2.3.2. Navigate algorithm</a>
    <li><a href="#ref-for-process-a-navigate-fetchâ ">2.3.3. Process a navigate fetch</a> <a href="#ref-for-process-a-navigate-fetchâ¡">(2)</a> <a href="#ref-for-process-a-navigate-fetchâ¢">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-task">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-task">4. Attribution Reporting API</a>
    <li><a href="#ref-for-queue-a-taskâ ">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-queue-a-taskâ¡">10.2. Should internalResponse to request be blocked as attribution trigger</a>
    <li><a href="#ref-for-queue-a-taskâ¢">11.4. Issuing a report request</a> <a href="#ref-for-queue-a-taskâ£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-reflect">
   <a href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect">https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reflect">2.1.  long long reflection </a>
    <li><a href="#ref-for-reflectâ ">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-concept-relevant-globalâ ">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relevant-settings-object">4. Attribution Reporting API</a>
    <li><a href="#ref-for-relevant-settings-objectâ ">9.5. Obtaining an attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-rules-for-parsing-integers">
   <a href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers">https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-integers</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rules-for-parsing-integers">2.1.  long long reflection </a>
    <li><a href="#ref-for-rules-for-parsing-integersâ ">10.1. Creating an attribution trigger</a> <a href="#ref-for-rules-for-parsing-integersâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-rules-for-parsing-non-negative-integers">
   <a href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers">https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rules-for-parsing-non-negative-integers">2.1.  long long reflection </a>
    <li><a href="#ref-for-rules-for-parsing-non-negative-integersâ ">9.2. Parsing data fields</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-same-origin">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">https://html.spec.whatwg.org/multipage/origin.html#same-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-same-origin">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-same-originâ ">10.2. Should internalResponse to request be blocked as attribution trigger</a>
    <li><a href="#ref-for-same-originâ¡">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-same-site">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#same-site">https://html.spec.whatwg.org/multipage/origin.html#same-site</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-same-site">1.1. Overview</a>
    <li><a href="#ref-for-same-siteâ ">2.2. &lt;a> element</a>
    <li><a href="#ref-for-same-siteâ¡">2.3. Navigation</a>
    <li><a href="#ref-for-same-siteâ¢">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-scheme">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-scheme">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-site">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#site">https://html.spec.whatwg.org/multipage/origin.html#site</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-site">6.2. Attribution source</a>
    <li><a href="#ref-for-siteâ ">6.3. Attribution trigger</a>
    <li><a href="#ref-for-siteâ¡">6.4. Attribution report</a>
    <li><a href="#ref-for-siteâ¢">6.5. Attribution rate-limit record</a> <a href="#ref-for-siteâ£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-top-level-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-top-level-browsing-context">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-top-level-origin">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-concept-environment-top-level-originâ ">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-concept-environment-top-level-originâ¡">10.2. Should internalResponse to request be blocked as attribution trigger</a> <a href="#ref-for-concept-environment-top-level-originâ¢">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-append">
   <a href="https://infra.spec.whatwg.org/#set-append">https://infra.spec.whatwg.org/#set-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-append">9.4. Obtaining a random attribution mode</a>
    <li><a href="#ref-for-set-appendâ ">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-byte-sequence">
   <a href="https://infra.spec.whatwg.org/#byte-sequence">https://infra.spec.whatwg.org/#byte-sequence</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byte-sequence">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-contain">
   <a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-contain">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-exists">
   <a href="https://infra.spec.whatwg.org/#map-exists">https://infra.spec.whatwg.org/#map-exists</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-exists">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-map-existsâ ">(2)</a> <a href="#ref-for-map-existsâ¡">(3)</a> <a href="#ref-for-map-existsâ¢">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-implementation-defined">
   <a href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined">11. Report delivery</a> <a href="#ref-for-implementation-definedâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string-is">
   <a href="https://infra.spec.whatwg.org/#string-is">https://infra.spec.whatwg.org/#string-is</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-is">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-iterate">
   <a href="https://infra.spec.whatwg.org/#list-iterate">https://infra.spec.whatwg.org/#list-iterate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-iterate">11. Report delivery</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-map">
   <a href="https://infra.spec.whatwg.org/#ordered-map">https://infra.spec.whatwg.org/#ordered-map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-map">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
   <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-set">6.2. Attribution source</a>
    <li><a href="#ref-for-ordered-setâ ">7. Storage</a> <a href="#ref-for-ordered-setâ¡">(2)</a> <a href="#ref-for-ordered-setâ¢">(3)</a>
    <li><a href="#ref-for-ordered-setâ£">8.1. Obtaining a randomized response</a>
    <li><a href="#ref-for-ordered-setâ¤">9.4. Obtaining a random attribution mode</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-remove">
   <a href="https://infra.spec.whatwg.org/#list-remove">https://infra.spec.whatwg.org/#list-remove</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-remove">9.9. Processing an attribution source</a> <a href="#ref-for-list-removeâ ">(2)</a>
    <li><a href="#ref-for-list-removeâ¡">10.4. Triggering attribution</a> <a href="#ref-for-list-removeâ¢">(2)</a> <a href="#ref-for-list-removeâ£">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-serialize-an-infra-value-to-json-bytes">
   <a href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes">https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serialize-an-infra-value-to-json-bytes">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
   <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-set">6.2. Attribution source</a>
    <li><a href="#ref-for-ordered-setâ ">7. Storage</a> <a href="#ref-for-ordered-setâ¡">(2)</a> <a href="#ref-for-ordered-setâ¢">(3)</a>
    <li><a href="#ref-for-ordered-setâ£">8.1. Obtaining a randomized response</a>
    <li><a href="#ref-for-ordered-setâ¤">9.4. Obtaining a random attribution mode</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-size">
   <a href="https://infra.spec.whatwg.org/#list-size">https://infra.spec.whatwg.org/#list-size</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-size">9.9. Processing an attribution source</a> <a href="#ref-for-list-sizeâ ">(2)</a>
    <li><a href="#ref-for-list-sizeâ¡">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-list-sizeâ¢">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-sort-in-ascending-order">
   <a href="https://infra.spec.whatwg.org/#list-sort-in-ascending-order">https://infra.spec.whatwg.org/#list-sort-in-ascending-order</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-sort-in-ascending-order">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-sort-in-descending-order">
   <a href="https://infra.spec.whatwg.org/#list-sort-in-descending-order">https://infra.spec.whatwg.org/#list-sort-in-descending-order</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-sort-in-descending-order">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string">
   <a href="https://infra.spec.whatwg.org/#string">https://infra.spec.whatwg.org/#string</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string">6.2. Attribution source</a>
    <li><a href="#ref-for-stringâ ">9.2. Parsing data fields</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct">
   <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct">6.2. Attribution source</a>
    <li><a href="#ref-for-structâ ">6.3. Attribution trigger</a>
    <li><a href="#ref-for-structâ¡">6.4. Attribution report</a>
    <li><a href="#ref-for-structâ¢">6.5. Attribution rate-limit record</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-tuple">
   <a href="https://infra.spec.whatwg.org/#tuple">https://infra.spec.whatwg.org/#tuple</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-tuple">6.1. Attribution mode</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-default-allowlist">
   <a href="https://w3c.github.io/webappsec-permissions-policy/#default-allowlist">https://w3c.github.io/webappsec-permissions-policy/#default-allowlist</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-allowlist">5. Permissions Policy integration</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-policy-controlled-feature">
   <a href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature">https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-policy-controlled-feature">5. Permissions Policy integration</a>
    <li><a href="#ref-for-policy-controlled-featureâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-policy-controlled-featureâ¡">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-potentially-trustworthy-origin">
   <a href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin">https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-potentially-trustworthy-origin">10.2. Should internalResponse to request be blocked as attribution trigger</a> <a href="#ref-for-potentially-trustworthy-originâ ">(2)</a> <a href="#ref-for-potentially-trustworthy-originâ¡">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-storage-bottle">
   <a href="https://storage.spec.whatwg.org/#storage-bottle">https://storage.spec.whatwg.org/#storage-bottle</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-storage-bottle">7. Storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-host">
   <a href="https://url.spec.whatwg.org/#concept-url-host">https://url.spec.whatwg.org/#concept-url-host</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-host">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-origin">
   <a href="https://url.spec.whatwg.org/#concept-url-origin">https://url.spec.whatwg.org/#concept-url-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-origin">2.2. &lt;a> element</a> <a href="#ref-for-concept-url-originâ ">(2)</a>
    <li><a href="#ref-for-concept-url-originâ¡">6.2. Attribution source</a> <a href="#ref-for-concept-url-originâ¢">(2)</a>
    <li><a href="#ref-for-concept-url-originâ£">6.3. Attribution trigger</a>
    <li><a href="#ref-for-concept-url-originâ¤">6.4. Attribution report</a>
    <li><a href="#ref-for-concept-url-originâ¥">9.3. Parsing an attribution destination</a> <a href="#ref-for-concept-url-originâ¦">(2)</a>
    <li><a href="#ref-for-concept-url-originâ§">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-concept-url-originâ¨">(2)</a>
    <li><a href="#ref-for-concept-url-originâ âª">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-concept-url-originâ â ">10.2. Should internalResponse to request be blocked as attribution trigger</a> <a href="#ref-for-concept-url-originâ â¡">(2)</a> <a href="#ref-for-concept-url-originâ â¢">(3)</a> <a href="#ref-for-concept-url-originâ â£">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-path">
   <a href="https://url.spec.whatwg.org/#concept-url-path">https://url.spec.whatwg.org/#concept-url-path</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-path">10.2. Should internalResponse to request be blocked as attribution trigger</a>
    <li><a href="#ref-for-concept-url-pathâ ">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-port">
   <a href="https://url.spec.whatwg.org/#concept-url-port">https://url.spec.whatwg.org/#concept-url-port</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-port">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-query">
   <a href="https://url.spec.whatwg.org/#concept-url-query">https://url.spec.whatwg.org/#concept-url-query</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-query">10.1. Creating an attribution trigger</a> <a href="#ref-for-concept-url-queryâ ">(2)</a> <a href="#ref-for-concept-url-queryâ¡">(3)</a> <a href="#ref-for-concept-url-queryâ¢">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-scheme">
   <a href="https://url.spec.whatwg.org/#concept-url-scheme">https://url.spec.whatwg.org/#concept-url-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-scheme">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url">
   <a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-concept-urlâ ">10.2. Should internalResponse to request be blocked as attribution trigger</a>
    <li><a href="#ref-for-concept-urlâ¡">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-parser">
   <a href="https://url.spec.whatwg.org/#concept-url-parser">https://url.spec.whatwg.org/#concept-url-parser</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-parser">9.3. Parsing an attribution destination</a>
    <li><a href="#ref-for-concept-url-parserâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url">
   <a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-concept-urlâ ">10.2. Should internalResponse to request be blocked as attribution trigger</a>
    <li><a href="#ref-for-concept-urlâ¡">11.3. Get report request URL</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-generate-a-random-uuid">
   <a href="https://wicg.github.io/uuid/#dfn-generate-a-random-uuid">https://wicg.github.io/uuid/#dfn-generate-a-random-uuid</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-generate-a-random-uuid">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMException">
   <a href="https://webidl.spec.whatwg.org/#idl-DOMException">https://webidl.spec.whatwg.org/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">2.1.  long long reflection </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
   <a href="https://webidl.spec.whatwg.org/#idl-DOMString">https://webidl.spec.whatwg.org/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">2.2. &lt;a> element</a>
    <li><a href="#ref-for-idl-DOMStringâ ">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://webidl.spec.whatwg.org/#Exposed">https://webidl.spec.whatwg.org/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-indexsizeerror">
   <a href="https://webidl.spec.whatwg.org/#indexsizeerror">https://webidl.spec.whatwg.org/#indexsizeerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-indexsizeerror">2.1.  long long reflection </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
   <a href="https://webidl.spec.whatwg.org/#idl-promise">https://webidl.spec.whatwg.org/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SecureContext">
   <a href="https://webidl.spec.whatwg.org/#SecureContext">https://webidl.spec.whatwg.org/#SecureContext</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SecureContext">4. Attribution Reporting API</a> <a href="#ref-for-SecureContextâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
   <a href="https://webidl.spec.whatwg.org/#idl-USVString">https://webidl.spec.whatwg.org/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">2.2. &lt;a> element</a> <a href="#ref-for-idl-USVStringâ ">(2)</a>
    <li><a href="#ref-for-idl-USVStringâ¡">4. Attribution Reporting API</a> <a href="#ref-for-idl-USVStringâ¢">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-rejected-with">
   <a href="https://webidl.spec.whatwg.org/#a-promise-rejected-with">https://webidl.spec.whatwg.org/#a-promise-rejected-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-rejected-with">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-resolved-with">
   <a href="https://webidl.spec.whatwg.org/#a-promise-resolved-with">https://webidl.spec.whatwg.org/#a-promise-resolved-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-resolved-with">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-boolean">
   <a href="https://webidl.spec.whatwg.org/#idl-boolean">https://webidl.spec.whatwg.org/#idl-boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-boolean">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-long-long">
   <a href="https://webidl.spec.whatwg.org/#idl-long-long">https://webidl.spec.whatwg.org/#idl-long-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-long-long">2.1.  long long reflection </a> <a href="#ref-for-idl-long-longâ ">(2)</a>
    <li><a href="#ref-for-idl-long-longâ¡">2.2. &lt;a> element</a> <a href="#ref-for-idl-long-longâ¢">(2)</a>
    <li><a href="#ref-for-idl-long-longâ£">4. Attribution Reporting API</a> <a href="#ref-for-idl-long-longâ¤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-this">
   <a href="https://webidl.spec.whatwg.org/#this">https://webidl.spec.whatwg.org/#this</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-this">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-undefined">
   <a href="https://webidl.spec.whatwg.org/#idl-undefined">https://webidl.spec.whatwg.org/#idl-undefined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-undefined">4. Attribution Reporting API</a> <a href="#ref-for-idl-undefinedâ ">(2)</a> <a href="#ref-for-idl-undefinedâ¡">(3)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-body">body</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-current-url">current url</span>
     <li><span class="dfn-paneled" id="term-for-concept-fetch">fetch</span>
     <li><span class="dfn-paneled" id="term-for-concept-header">header</span>
     <li><span class="dfn-paneled" id="term-for-concept-header-list">header list</span>
     <li><span class="dfn-paneled" id="term-for-concept-main-fetch">main fetch</span>
     <li><span class="dfn-paneled" id="term-for-process-response">processresponse</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-redirect-count">redirect count</span>
     <li><span class="dfn-paneled" id="term-for-concept-request">request</span>
     <li><span class="dfn-paneled" id="term-for-concept-body-source">source</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-url-list">url list</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-window">window</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-cereactions">CEReactions</span>
     <li><span class="dfn-paneled" id="term-for-htmlanchorelement">HTMLAnchorElement</span>
     <li><span class="dfn-paneled" id="term-for-window">Window</span>
     <li><span class="dfn-paneled" id="term-for-the-a-element">a</span>
     <li><span class="dfn-paneled" id="term-for-allowed-to-use">allowed to use</span>
     <li><span class="dfn-paneled" id="term-for-concept-document-window">associated document</span>
     <li><span class="dfn-paneled" id="term-for-browsing-context">browsing context</span>
     <li><span class="dfn-paneled" id="term-for-concept-element-attributes">content attributes</span>
     <li><span class="dfn-paneled" id="term-for-initialise-the-document-object">create and initialize a document object</span>
     <li><span class="dfn-paneled" id="term-for-concept-element-dom">dom interface</span>
     <li><span class="dfn-paneled" id="term-for-environment-settings-object">environment settings object</span>
     <li><span class="dfn-paneled" id="term-for-following-hyperlinks-2">follow the hyperlink</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-host">host</span>
     <li><span class="dfn-paneled" id="term-for-in-parallel">in parallel</span>
     <li><span class="dfn-paneled" id="term-for-navigate">navigate</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params">navigation params</span>
     <li><span class="dfn-paneled" id="term-for-obtain-a-site">obtain a site</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-opaque">opaque origin</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-origin">origin <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-port">port</span>
     <li><span class="dfn-paneled" id="term-for-process-a-navigate-fetch">process a navigate fetch</span>
     <li><span class="dfn-paneled" id="term-for-queue-a-task">queue a task</span>
     <li><span class="dfn-paneled" id="term-for-reflect">reflect</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
     <li><span class="dfn-paneled" id="term-for-relevant-settings-object">relevant settings object</span>
     <li><span class="dfn-paneled" id="term-for-rules-for-parsing-integers">rules for parsing integers</span>
     <li><span class="dfn-paneled" id="term-for-rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</span>
     <li><span class="dfn-paneled" id="term-for-same-origin">same origin</span>
     <li><span class="dfn-paneled" id="term-for-same-site">same site</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-scheme">scheme</span>
     <li><span class="dfn-paneled" id="term-for-site">site</span>
     <li><span class="dfn-paneled" id="term-for-top-level-browsing-context">top-level browsing context</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-origin">top-level origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-set-append">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="term-for-byte-sequence">byte sequence</span>
     <li><span class="dfn-paneled" id="term-for-list-contain">contain</span>
     <li><span class="dfn-paneled" id="term-for-map-exists">exist</span>
     <li><span class="dfn-paneled" id="term-for-implementation-defined">implementation-defined</span>
     <li><span class="dfn-paneled" id="term-for-string-is">is</span>
     <li><span class="dfn-paneled" id="term-for-list-iterate">iterate</span>
     <li><span class="dfn-paneled" id="term-for-ordered-map">map</span>
     <li><span class="dfn-paneled" id="term-for-ordered-set">ordered set</span>
     <li><span class="dfn-paneled" id="term-for-list-remove">remove</span>
     <li><span class="dfn-paneled" id="term-for-serialize-an-infra-value-to-json-bytes">serialize an infra value to json bytes</span>
     <li><span class="dfn-paneled" id="term-for-ordered-setâ ">set</span>
     <li><span class="dfn-paneled" id="term-for-list-size">size</span>
     <li><span class="dfn-paneled" id="term-for-list-sort-in-ascending-order">sort in ascending order</span>
     <li><span class="dfn-paneled" id="term-for-list-sort-in-descending-order">sort in descending order</span>
     <li><span class="dfn-paneled" id="term-for-string">string</span>
     <li><span class="dfn-paneled" id="term-for-struct">struct</span>
     <li><span class="dfn-paneled" id="term-for-tuple">tuple</span>
    </ul>
   <li>
    <a data-link-type="biblio">[permissions-policy-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-default-allowlist">default allowlist</span>
     <li><span class="dfn-paneled" id="term-for-policy-controlled-feature">policy-controlled feature</span>
    </ul>
   <li>
    <a data-link-type="biblio">[secure-contexts]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-potentially-trustworthy-origin">potentially trustworthy origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STORAGE]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-storage-bottle">storage bottle</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-url-host">host</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-origin">origin</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-path">path</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-port">port</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-query">query</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-scheme">scheme</span>
     <li><span class="dfn-paneled" id="term-for-concept-url">url</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-parser">url parser</span>
     <li><span class="dfn-paneled" id="term-for-concept-urlâ ">url record</span>
    </ul>
   <li>
    <a data-link-type="biblio">[uuid]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dfn-generate-a-random-uuid">generate a random uuid</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-DOMException">DOMException</span>
     <li><span class="dfn-paneled" id="term-for-idl-DOMString">DOMString</span>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-indexsizeerror">IndexSizeError</span>
     <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
     <li><span class="dfn-paneled" id="term-for-SecureContext">SecureContext</span>
     <li><span class="dfn-paneled" id="term-for-idl-USVString">USVString</span>
     <li><span class="dfn-paneled" id="term-for-a-promise-rejected-with">a promise rejected with</span>
     <li><span class="dfn-paneled" id="term-for-a-promise-resolved-with">a promise resolved with</span>
     <li><span class="dfn-paneled" id="term-for-idl-boolean">boolean</span>
     <li><span class="dfn-paneled" id="term-for-idl-long-long">long long</span>
     <li><span class="dfn-paneled" id="term-for-this">this</span>
     <li><span class="dfn-paneled" id="term-for-idl-undefined">undefined</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-permissions-policy-1">[PERMISSIONS-POLICY-1]
   <dd>Ian Clelland. <a href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a>. 16 July 2020. WD. URL: <a href="https://www.w3.org/TR/permissions-policy-1/">https://www.w3.org/TR/permissions-policy-1/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://www.w3.org/TR/secure-contexts/">Secure Contexts</a>. 18 September 2021. CR. URL: <a href="https://www.w3.org/TR/secure-contexts/">https://www.w3.org/TR/secure-contexts/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/">URL Standard</a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/">Web IDL Standard</a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-storage">[STORAGE]
   <dd>Anne van Kesteren. <a href="https://storage.spec.whatwg.org/">Storage Standard</a>. Living Standard. URL: <a href="https://storage.spec.whatwg.org/">https://storage.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#htmlanchorelement"><c- g>HTMLAnchorElement</c-></a> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString" href="#dom-htmlanchorelement-attributiondestination"><code><c- g>attributionDestination</c-></code></a>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString" href="#dom-htmlanchorelement-attributionsourceeventid"><code><c- g>attributionSourceEventId</c-></code></a>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString" href="#dom-htmlanchorelement-attributionreportto"><code><c- g>attributionReportTo</c-></code></a>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long"><c- b>long</c-> <c- b>long</c-></a> <a data-type="long long" href="#dom-htmlanchorelement-attributionexpiry"><code><c- g>attributionExpiry</c-></code></a>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long"><c- b>long</c-> <c- b>long</c-></a> <a data-type="long long" href="#dom-htmlanchorelement-attributionsourcepriority"><code><c- g>attributionSourcePriority</c-></code></a>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-type="boolean" href="#dom-htmlanchorelement-registerattributionsource"><code><c- g>registerAttributionSource</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-attributionsourceparams"><code><c- g>AttributionSourceParams</c-></code></a> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-attributionsourceparams-attributiondestination"><code><c- g>attributionDestination</c-></code></a>;
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-attributionsourceparams-attributionsourceeventid"><code><c- g>attributionSourceEventId</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-attributionsourceparams-attributionreportto"><code><c- g>attributionReportTo</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long"><c- b>long</c-> <c- b>long</c-></a> <a data-type="long long " href="#dom-attributionsourceparams-attributionexpiry"><code><c- g>attributionExpiry</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long"><c- b>long</c-> <c- b>long</c-></a> <a data-type="long long " href="#dom-attributionsourceparams-attributionsourcepriority"><code><c- g>attributionSourcePriority</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a href="#attributionreporting"><code><c- g>AttributionReporting</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-attributionreporting-registerattributionsource"><c- g>registerAttributionSource</c-></a>(<a data-link-type="idl-name" href="#dictdef-attributionsourceparams"><c- n>AttributionSourceParams</c-></a> <a href="#dom-attributionreporting-registerattributionsource-params-params"><code><c- g>params</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window"><c- g>Window</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#attributionreporting"><c- n>AttributionReporting</c-></a> <a data-readonly data-type="AttributionReporting" href="#dom-window-attributionreporting"><code><c- g>attributionReporting</c-></code></a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Should fake reports respect the user agentâs <a data-link-type="dfn" href="#max-reports-per-attribution-destination">max reports per attribution destination</a>?<a href="#issue-82e83119"> âµ </a></div>
   <div class="issue"> Formalize how to parse the query similar to URLSearchParams.<a href="#issue-9d1372db"> âµ </a></div>
   <div class="issue"> This would ideally be replaced by a more descriptive algorithm in Infra. See <a href="https://github.com/whatwg/infra/issues/201">infra/201</a><a href="#issue-ccb90c6c"> âµ </a></div>
   <div class="issue"> This fetch should use a network partition key for an opaque origin. <a href="https://github.com/WICG/conversion-measurement-api/issues/220">&lt;https://github.com/WICG/conversion-measurement-api/issues/220></a><a href="#issue-c8706ee1"> âµ </a></div>
  </div>
  <aside class="dfn-panel" data-for="limited-to-only-non-negative-numbers">
   <b><a href="#limited-to-only-non-negative-numbers">#limited-to-only-non-negative-numbers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-limited-to-only-non-negative-numbers">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-htmlanchorelement-attributiondestination">
   <b><a href="#dom-htmlanchorelement-attributiondestination">#dom-htmlanchorelement-attributiondestination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmlanchorelement-attributiondestination">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-htmlanchorelement-attributionsourceeventid">
   <b><a href="#dom-htmlanchorelement-attributionsourceeventid">#dom-htmlanchorelement-attributionsourceeventid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmlanchorelement-attributionsourceeventid">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-htmlanchorelement-attributionreportto">
   <b><a href="#dom-htmlanchorelement-attributionreportto">#dom-htmlanchorelement-attributionreportto</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmlanchorelement-attributionreportto">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-htmlanchorelement-attributionexpiry">
   <b><a href="#dom-htmlanchorelement-attributionexpiry">#dom-htmlanchorelement-attributionexpiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmlanchorelement-attributionexpiry">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-htmlanchorelement-attributionsourcepriority">
   <b><a href="#dom-htmlanchorelement-attributionsourcepriority">#dom-htmlanchorelement-attributionsourcepriority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmlanchorelement-attributionsourcepriority">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-htmlanchorelement-registerattributionsource">
   <b><a href="#dom-htmlanchorelement-registerattributionsource">#dom-htmlanchorelement-registerattributionsource</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmlanchorelement-registerattributionsource">2.2. &lt;a> element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="element-attrdef-a-attributiondestination">
   <b><a href="#element-attrdef-a-attributiondestination">#element-attrdef-a-attributiondestination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-a-attributiondestination">1.1. Overview</a> <a href="#ref-for-element-attrdef-a-attributiondestinationâ ">(2)</a> <a href="#ref-for-element-attrdef-a-attributiondestinationâ¡">(3)</a>
    <li><a href="#ref-for-element-attrdef-a-attributiondestinationâ¢">2.2. &lt;a> element</a>
    <li><a href="#ref-for-element-attrdef-a-attributiondestinationâ£">9.5. Obtaining an attribution source from an a element</a> <a href="#ref-for-element-attrdef-a-attributiondestinationâ¤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="element-attrdef-a-attributionsourceeventid">
   <b><a href="#element-attrdef-a-attributionsourceeventid">#element-attrdef-a-attributionsourceeventid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-a-attributionsourceeventid">1.1. Overview</a>
    <li><a href="#ref-for-element-attrdef-a-attributionsourceeventidâ ">2.2. &lt;a> element</a>
    <li><a href="#ref-for-element-attrdef-a-attributionsourceeventidâ¡">9.5. Obtaining an attribution source from an a element</a> <a href="#ref-for-element-attrdef-a-attributionsourceeventidâ¢">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="element-attrdef-a-attributionreportto">
   <b><a href="#element-attrdef-a-attributionreportto">#element-attrdef-a-attributionreportto</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-a-attributionreportto">2.2. &lt;a> element</a>
    <li><a href="#ref-for-element-attrdef-a-attributionreporttoâ ">9.5. Obtaining an attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="element-attrdef-a-attributionexpiry">
   <b><a href="#element-attrdef-a-attributionexpiry">#element-attrdef-a-attributionexpiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-a-attributionexpiry">2.2. &lt;a> element</a> <a href="#ref-for-element-attrdef-a-attributionexpiryâ ">(2)</a>
    <li><a href="#ref-for-element-attrdef-a-attributionexpiryâ¡">9.5. Obtaining an attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="element-attrdef-a-attributionsourcepriority">
   <b><a href="#element-attrdef-a-attributionsourcepriority">#element-attrdef-a-attributionsourcepriority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-a-attributionsourcepriority">2.2. &lt;a> element</a>
    <li><a href="#ref-for-element-attrdef-a-attributionsourcepriorityâ ">9.5. Obtaining an attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="element-attrdef-a-registerattributionsource">
   <b><a href="#element-attrdef-a-registerattributionsource">#element-attrdef-a-registerattributionsource</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-a-registerattributionsource">1.1. Overview</a>
    <li><a href="#ref-for-element-attrdef-a-registerattributionsourceâ ">2.2. &lt;a> element</a>
    <li><a href="#ref-for-element-attrdef-a-registerattributionsourceâ¡">9.6. Obtaining an event attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigation-params-attribution-source">
   <b><a href="#navigation-params-attribution-source">#navigation-params-attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-attribution-source">2.3.2. Navigate algorithm</a> <a href="#ref-for-navigation-params-attribution-sourceâ ">(2)</a>
    <li><a href="#ref-for-navigation-params-attribution-sourceâ¡">2.3.3. Process a navigate fetch</a>
    <li><a href="#ref-for-navigation-params-attribution-sourceâ¢">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-attributionsourceparams">
   <b><a href="#dictdef-attributionsourceparams">#dictdef-attributionsourceparams</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-attributionsourceparams">4. Attribution Reporting API</a>
    <li><a href="#ref-for-dictdef-attributionsourceparamsâ ">9.5. Obtaining an attribution source from an a element</a>
    <li><a href="#ref-for-dictdef-attributionsourceparamsâ¡">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-dictdef-attributionsourceparamsâ¢">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-attributionsourceparams-attributiondestination">
   <b><a href="#dom-attributionsourceparams-attributiondestination">#dom-attributionsourceparams-attributiondestination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-attributionsourceparams-attributiondestination">9.5. Obtaining an attribution source from an a element</a>
    <li><a href="#ref-for-dom-attributionsourceparams-attributiondestinationâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-dom-attributionsourceparams-attributiondestinationâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-attributionsourceparams-attributionsourceeventid">
   <b><a href="#dom-attributionsourceparams-attributionsourceeventid">#dom-attributionsourceparams-attributionsourceeventid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionsourceeventid">9.5. Obtaining an attribution source from an a element</a>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionsourceeventidâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-dom-attributionsourceparams-attributionsourceeventidâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-attributionsourceparams-attributionreportto">
   <b><a href="#dom-attributionsourceparams-attributionreportto">#dom-attributionsourceparams-attributionreportto</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionreportto">9.5. Obtaining an attribution source from an a element</a>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionreporttoâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-dom-attributionsourceparams-attributionreporttoâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-attributionsourceparams-attributionexpiry">
   <b><a href="#dom-attributionsourceparams-attributionexpiry">#dom-attributionsourceparams-attributionexpiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionexpiry">9.5. Obtaining an attribution source from an a element</a>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionexpiryâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-attributionsourceparams-attributionsourcepriority">
   <b><a href="#dom-attributionsourceparams-attributionsourcepriority">#dom-attributionsourceparams-attributionsourcepriority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionsourcepriority">9.5. Obtaining an attribution source from an a element</a>
    <li><a href="#ref-for-dom-attributionsourceparams-attributionsourcepriorityâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attributionreporting">
   <b><a href="#attributionreporting">#attributionreporting</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attributionreporting">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-attributionreporting-registerattributionsource">
   <b><a href="#dom-attributionreporting-registerattributionsource">#dom-attributionreporting-registerattributionsource</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-attributionreporting-registerattributionsource">4. Attribution Reporting API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-reporting">
   <b><a href="#attribution-reporting">#attribution-reporting</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-reporting">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-reportingâ ">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-mode">
   <b><a href="#attribution-mode">#attribution-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-mode">6.1. Attribution mode</a>
    <li><a href="#ref-for-attribution-mode">6.2. Attribution source</a>
    <li><a href="#ref-for-attribution-modeâ ">9.4. Obtaining a random attribution mode</a> <a href="#ref-for-attribution-modeâ¡">(2)</a> <a href="#ref-for-attribution-modeâ¢">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source">
   <b><a href="#attribution-source">#attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source">1.1. Overview</a> <a href="#ref-for-attribution-sourceâ ">(2)</a> <a href="#ref-for-attribution-sourceâ¡">(3)</a> <a href="#ref-for-attribution-sourceâ¢">(4)</a>
    <li><a href="#ref-for-attribution-sourceâ£">2.2. &lt;a> element</a>
    <li><a href="#ref-for-attribution-sourceâ¤">2.3. Navigation</a>
    <li><a href="#ref-for-attribution-sourceâ¥">2.3.1. Navigation Params</a>
    <li><a href="#ref-for-attribution-sourceâ¦">2.3.2. Navigate algorithm</a>
    <li><a href="#ref-for-attribution-sourceâ§">2.3.3. Process a navigate fetch</a>
    <li><a href="#ref-for-attribution-source">6.2. Attribution source</a> <a href="#ref-for-attribution-sourceâ¨">(2)</a> <a href="#ref-for-attribution-sourceâ âª">(3)</a>
    <li><a href="#ref-for-attribution-sourceâ â ">7. Storage</a>
    <li><a href="#ref-for-attribution-sourceâ â¡">9.1. Obtaining an attribution sourceâs expiry time</a>
    <li><a href="#ref-for-attribution-sourceâ â¢">9.7. Obtaining an event attribution source from a source</a> <a href="#ref-for-attribution-sourceâ â£">(2)</a>
    <li><a href="#ref-for-attribution-sourceâ â¤">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-sourceâ â¥">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-sourceâ â¦">(2)</a> <a href="#ref-for-attribution-sourceâ â§">(3)</a>
    <li><a href="#ref-for-attribution-sourceâ â¨">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-sourceâ¡âª">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-sourceâ¡â ">10.5. Establishing report delivery time</a>
    <li><a href="#ref-for-attribution-sourceâ¡â¡">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-identifier">
   <b><a href="#attribution-source-source-identifier">#attribution-source-source-identifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-identifier">9.7. Obtaining an event attribution source from a source</a>
    <li><a href="#ref-for-attribution-source-source-identifierâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-source-identifierâ¡">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-origin">
   <b><a href="#attribution-source-source-origin">#attribution-source-source-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-origin">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-source-originâ ">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-source-source-originâ¡">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-source-source-originâ¢">11. Report delivery</a>
    <li><a href="#ref-for-attribution-source-source-originâ£">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-event-id">
   <b><a href="#attribution-source-event-id">#attribution-source-event-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-event-id">9.2. Parsing data fields</a>
    <li><a href="#ref-for-attribution-source-event-idâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a> <a href="#ref-for-attribution-source-event-idâ¡">(2)</a>
    <li><a href="#ref-for-attribution-source-event-idâ¢">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-attribution-destination">
   <b><a href="#attribution-source-attribution-destination">#attribution-source-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-attribution-destination">2.2. &lt;a> element</a>
    <li><a href="#ref-for-attribution-source-attribution-destinationâ ">2.3. Navigation</a>
    <li><a href="#ref-for-attribution-source-attribution-destinationâ¡">2.3.4. Document creation</a>
    <li><a href="#ref-for-attribution-source-attribution-destinationâ¢">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-attribution-destinationâ£">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-attribution-destinationâ¤">(2)</a> <a href="#ref-for-attribution-source-attribution-destinationâ¥">(3)</a> <a href="#ref-for-attribution-source-attribution-destinationâ¦">(4)</a>
    <li><a href="#ref-for-attribution-source-attribution-destinationâ§">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-source-attribution-destinationâ¨">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-source-attribution-destinationâ âª">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-reporting-endpoint">
   <b><a href="#attribution-source-reporting-endpoint">#attribution-source-reporting-endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-reporting-endpoint">2.2. &lt;a> element</a>
    <li><a href="#ref-for-attribution-source-reporting-endpointâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-reporting-endpointâ¡">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-reporting-endpointâ¢">(2)</a> <a href="#ref-for-attribution-source-reporting-endpointâ£">(3)</a>
    <li><a href="#ref-for-attribution-source-reporting-endpointâ¤">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-source-reporting-endpointâ¥">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-source-reporting-endpointâ¦">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-type">
   <b><a href="#attribution-source-source-type">#attribution-source-source-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-type">2.2. &lt;a> element</a>
    <li><a href="#ref-for-attribution-source-source-typeâ ">9.7. Obtaining an event attribution source from a source</a> <a href="#ref-for-attribution-source-source-typeâ¡">(2)</a>
    <li><a href="#ref-for-attribution-source-source-typeâ¢">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-source-typeâ£">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-source-typeâ¤">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-source-source-typeâ¥">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-source-source-typeâ¦">10.5. Establishing report delivery time</a>
    <li><a href="#ref-for-attribution-source-source-typeâ§">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-expiry">
   <b><a href="#attribution-source-expiry">#attribution-source-expiry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-expiry">9.1. Obtaining an attribution sourceâs expiry time</a>
    <li><a href="#ref-for-attribution-source-expiryâ ">9.7. Obtaining an event attribution source from a source</a>
    <li><a href="#ref-for-attribution-source-expiryâ¡">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-expiryâ¢">10.5. Establishing report delivery time</a> <a href="#ref-for-attribution-source-expiryâ£">(2)</a> <a href="#ref-for-attribution-source-expiryâ¤">(3)</a> <a href="#ref-for-attribution-source-expiryâ¥">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-priority">
   <b><a href="#attribution-source-priority">#attribution-source-priority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-priority">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-priorityâ ">10.4. Triggering attribution</a> <a href="#ref-for-attribution-source-priorityâ¡">(2)</a> <a href="#ref-for-attribution-source-priorityâ¢">(3)</a> <a href="#ref-for-attribution-source-priorityâ£">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-source-time">
   <b><a href="#attribution-source-source-time">#attribution-source-source-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-source-time">9.1. Obtaining an attribution sourceâs expiry time</a>
    <li><a href="#ref-for-attribution-source-source-timeâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-source-timeâ¡">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-source-timeâ¢">10.4. Triggering attribution</a> <a href="#ref-for-attribution-source-source-timeâ£">(2)</a>
    <li><a href="#ref-for-attribution-source-source-timeâ¤">10.5. Establishing report delivery time</a> <a href="#ref-for-attribution-source-source-timeâ¥">(2)</a> <a href="#ref-for-attribution-source-source-timeâ¦">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-number-of-reports">
   <b><a href="#attribution-source-number-of-reports">#attribution-source-number-of-reports</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-number-of-reports">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-number-of-reportsâ ">10.4. Triggering attribution</a> <a href="#ref-for-attribution-source-number-of-reportsâ¡">(2)</a> <a href="#ref-for-attribution-source-number-of-reportsâ¢">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-dedup-keys">
   <b><a href="#attribution-source-dedup-keys">#attribution-source-dedup-keys</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-dedup-keys">10.4. Triggering attribution</a> <a href="#ref-for-attribution-source-dedup-keysâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-attribution-mode">
   <b><a href="#attribution-source-attribution-mode">#attribution-source-attribution-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-attribution-mode">9.7. Obtaining an event attribution source from a source</a> <a href="#ref-for-attribution-source-attribution-modeâ ">(2)</a>
    <li><a href="#ref-for-attribution-source-attribution-modeâ¡">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-attribution-modeâ¢">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-attribution-modeâ£">(2)</a>
    <li><a href="#ref-for-attribution-source-attribution-modeâ¤">10.4. Triggering attribution</a> <a href="#ref-for-attribution-source-attribution-modeâ¥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-randomized-trigger-rate">
   <b><a href="#attribution-source-randomized-trigger-rate">#attribution-source-randomized-trigger-rate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-randomized-trigger-rate">9.7. Obtaining an event attribution source from a source</a>
    <li><a href="#ref-for-attribution-source-randomized-trigger-rateâ ">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-attribution-source-randomized-trigger-rateâ¡">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger">
   <b><a href="#attribution-trigger">#attribution-trigger</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger">1.1. Overview</a>
    <li><a href="#ref-for-attribution-triggerâ ">2.2. &lt;a> element</a>
    <li><a href="#ref-for-attribution-trigger">6.3. Attribution trigger</a>
    <li><a href="#ref-for-attribution-triggerâ¡">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-triggerâ¢">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-triggerâ£">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-triggerâ¤">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-triggerâ¥">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-attribution-destination">
   <b><a href="#attribution-trigger-attribution-destination">#attribution-trigger-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-attribution-destination">2.2. &lt;a> element</a>
    <li><a href="#ref-for-attribution-trigger-attribution-destinationâ ">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-attribution-destinationâ¡">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-attribution-destinationâ¢">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-trigger-attribution-destinationâ£">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-navigation-source-trigger-data">
   <b><a href="#attribution-trigger-navigation-source-trigger-data">#attribution-trigger-navigation-source-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-navigation-source-trigger-data">9.2. Parsing data fields</a>
    <li><a href="#ref-for-attribution-trigger-navigation-source-trigger-dataâ ">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-navigation-source-trigger-dataâ¡">10.1. Creating an attribution trigger</a> <a href="#ref-for-attribution-trigger-navigation-source-trigger-dataâ¢">(2)</a> <a href="#ref-for-attribution-trigger-navigation-source-trigger-dataâ£">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-event-source-trigger-data">
   <b><a href="#attribution-trigger-event-source-trigger-data">#attribution-trigger-event-source-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-event-source-trigger-data">9.2. Parsing data fields</a>
    <li><a href="#ref-for-attribution-trigger-event-source-trigger-dataâ ">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-event-source-trigger-dataâ¡">10.1. Creating an attribution trigger</a> <a href="#ref-for-attribution-trigger-event-source-trigger-dataâ¢">(2)</a> <a href="#ref-for-attribution-trigger-event-source-trigger-dataâ£">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-trigger-time">
   <b><a href="#attribution-trigger-trigger-time">#attribution-trigger-trigger-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-trigger-time">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-trigger-timeâ ">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-trigger-timeâ¡">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-trigger-trigger-timeâ¢">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-trigger-trigger-timeâ£">10.5. Establishing report delivery time</a>
    <li><a href="#ref-for-attribution-trigger-trigger-timeâ¤">10.6. Obtaining a report</a> <a href="#ref-for-attribution-trigger-trigger-timeâ¥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-reporting-endpoint">
   <b><a href="#attribution-trigger-reporting-endpoint">#attribution-trigger-reporting-endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-reporting-endpoint">2.2. &lt;a> element</a>
    <li><a href="#ref-for-attribution-trigger-reporting-endpointâ ">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-reporting-endpointâ¡">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-reporting-endpointâ¢">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-dedup-key">
   <b><a href="#attribution-trigger-dedup-key">#attribution-trigger-dedup-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-dedup-key">6.2. Attribution source</a>
    <li><a href="#ref-for-attribution-trigger-dedup-keyâ ">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-dedup-keyâ¡">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-dedup-keyâ¢">10.4. Triggering attribution</a> <a href="#ref-for-attribution-trigger-dedup-keyâ£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-trigger-priority">
   <b><a href="#attribution-trigger-priority">#attribution-trigger-priority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-trigger-priority">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-trigger-priorityâ ">10.1. Creating an attribution trigger</a>
    <li><a href="#ref-for-attribution-trigger-priorityâ¡">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report">
   <b><a href="#attribution-report">#attribution-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report">2.2. &lt;a> element</a> <a href="#ref-for-attribution-reportâ ">(2)</a>
    <li><a href="#ref-for-attribution-reportâ¡">6.2. Attribution source</a>
    <li><a href="#ref-for-attribution-report">6.4. Attribution report</a>
    <li><a href="#ref-for-attribution-reportâ¢">7. Storage</a>
    <li><a href="#ref-for-attribution-reportâ£">10.4. Triggering attribution</a> <a href="#ref-for-attribution-reportâ¤">(2)</a> <a href="#ref-for-attribution-reportâ¥">(3)</a>
    <li><a href="#ref-for-attribution-reportâ¦">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-reportâ§">11. Report delivery</a>
    <li><a href="#ref-for-attribution-reportâ¨">11.2. Serialize attribution report body</a>
    <li><a href="#ref-for-attribution-reportâ âª">11.3. Get report request URL</a>
    <li><a href="#ref-for-attribution-reportâ â ">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-event-id">
   <b><a href="#attribution-report-event-id">#attribution-report-event-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-event-id">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-report-event-idâ ">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-source-type">
   <b><a href="#attribution-report-source-type">#attribution-report-source-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-source-type">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-trigger-data">
   <b><a href="#attribution-report-trigger-data">#attribution-report-trigger-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-trigger-data">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-report-trigger-dataâ ">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-randomized-trigger-rate">
   <b><a href="#attribution-report-randomized-trigger-rate">#attribution-report-randomized-trigger-rate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-randomized-trigger-rate">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-report-randomized-trigger-rateâ ">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-reporting-endpoint">
   <b><a href="#attribution-report-reporting-endpoint">#attribution-report-reporting-endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-reporting-endpoint">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-report-reporting-endpointâ ">11.3. Get report request URL</a>
    <li><a href="#ref-for-attribution-report-reporting-endpointâ¡">11.4. Issuing a report request</a>
    <li><a href="#ref-for-attribution-report-reporting-endpointâ¢">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-attribution-destination">
   <b><a href="#attribution-report-attribution-destination">#attribution-report-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-attribution-destination">10.4. Triggering attribution</a> <a href="#ref-for-attribution-report-attribution-destinationâ ">(2)</a>
    <li><a href="#ref-for-attribution-report-attribution-destinationâ¡">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-report-attribution-destinationâ¢">11.2. Serialize attribution report body</a>
    <li><a href="#ref-for-attribution-report-attribution-destinationâ£">13.1. Clearing attribution storage</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-report-time">
   <b><a href="#attribution-report-report-time">#attribution-report-report-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-report-time">10.4. Triggering attribution</a> <a href="#ref-for-attribution-report-report-timeâ ">(2)</a>
    <li><a href="#ref-for-attribution-report-report-timeâ¡">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-report-report-timeâ¢">11. Report delivery</a> <a href="#ref-for-attribution-report-report-timeâ£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-trigger-priority">
   <b><a href="#attribution-report-trigger-priority">#attribution-report-trigger-priority</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-trigger-priority">10.4. Triggering attribution</a> <a href="#ref-for-attribution-report-trigger-priorityâ ">(2)</a> <a href="#ref-for-attribution-report-trigger-priorityâ¡">(3)</a> <a href="#ref-for-attribution-report-trigger-priorityâ¢">(4)</a> <a href="#ref-for-attribution-report-trigger-priorityâ£">(5)</a> <a href="#ref-for-attribution-report-trigger-priorityâ¤">(6)</a>
    <li><a href="#ref-for-attribution-report-trigger-priorityâ¥">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-trigger-time">
   <b><a href="#attribution-report-trigger-time">#attribution-report-trigger-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-trigger-time">10.4. Triggering attribution</a> <a href="#ref-for-attribution-report-trigger-timeâ ">(2)</a>
    <li><a href="#ref-for-attribution-report-trigger-timeâ¡">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-source-identifier">
   <b><a href="#attribution-report-source-identifier">#attribution-report-source-identifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-source-identifier">10.4. Triggering attribution</a> <a href="#ref-for-attribution-report-source-identifierâ ">(2)</a>
    <li><a href="#ref-for-attribution-report-source-identifierâ¡">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-delivered">
   <b><a href="#attribution-report-delivered">#attribution-report-delivered</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-delivered">11. Report delivery</a> <a href="#ref-for-attribution-report-deliveredâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-report-id">
   <b><a href="#attribution-report-report-id">#attribution-report-report-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-report-id">10.6. Obtaining a report</a>
    <li><a href="#ref-for-attribution-report-report-idâ ">11.2. Serialize attribution report body</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record">
   <b><a href="#attribution-rate-limit-record">#attribution-rate-limit-record</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record">6.5. Attribution rate-limit record</a>
    <li><a href="#ref-for-attribution-rate-limit-record">7. Storage</a>
    <li><a href="#ref-for-attribution-rate-limit-recordâ ">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-source-site">
   <b><a href="#attribution-rate-limit-record-source-site">#attribution-rate-limit-record-source-site</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-source-site">10.3. Should attribution be blocked by rate limit</a> <a href="#ref-for-attribution-rate-limit-record-source-siteâ ">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-source-siteâ¡">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-attribution-destination">
   <b><a href="#attribution-rate-limit-record-attribution-destination">#attribution-rate-limit-record-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-attribution-destination">10.3. Should attribution be blocked by rate limit</a> <a href="#ref-for-attribution-rate-limit-record-attribution-destinationâ ">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-attribution-destinationâ¡">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-source-type">
   <b><a href="#attribution-rate-limit-record-source-type">#attribution-rate-limit-record-source-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-source-type">10.3. Should attribution be blocked by rate limit</a> <a href="#ref-for-attribution-rate-limit-record-source-typeâ ">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-record-source-typeâ¡">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-record-trigger-time">
   <b><a href="#attribution-rate-limit-record-trigger-time">#attribution-rate-limit-record-trigger-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-record-trigger-time">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-record-trigger-timeâ ">10.4. Triggering attribution</a> <a href="#ref-for-attribution-rate-limit-record-trigger-timeâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-cache">
   <b><a href="#attribution-source-cache">#attribution-source-cache</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-cache">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-source-cacheâ ">(2)</a>
    <li><a href="#ref-for-attribution-source-cacheâ¡">10.4. Triggering attribution</a> <a href="#ref-for-attribution-source-cacheâ¢">(2)</a> <a href="#ref-for-attribution-source-cacheâ£">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-report-cache">
   <b><a href="#attribution-report-cache">#attribution-report-cache</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-report-cache">9.9. Processing an attribution source</a> <a href="#ref-for-attribution-report-cacheâ ">(2)</a>
    <li><a href="#ref-for-attribution-report-cacheâ¡">10.4. Triggering attribution</a> <a href="#ref-for-attribution-report-cacheâ¢">(2)</a> <a href="#ref-for-attribution-report-cacheâ£">(3)</a> <a href="#ref-for-attribution-report-cacheâ¤">(4)</a> <a href="#ref-for-attribution-report-cacheâ¥">(5)</a> <a href="#ref-for-attribution-report-cacheâ¦">(6)</a> <a href="#ref-for-attribution-report-cacheâ§">(7)</a>
    <li><a href="#ref-for-attribution-report-cacheâ¨">11. Report delivery</a>
    <li><a href="#ref-for-attribution-report-cacheâ âª">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-cache">
   <b><a href="#attribution-rate-limit-cache">#attribution-rate-limit-cache</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-cache">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-attribution-rate-limit-cacheâ ">10.4. Triggering attribution</a> <a href="#ref-for-attribution-rate-limit-cacheâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-caches">
   <b><a href="#attribution-caches">#attribution-caches</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-caches">7. Storage</a>
    <li><a href="#ref-for-attribution-cachesâ ">13.1. Clearing attribution storage</a> <a href="#ref-for-attribution-cachesâ¡">(2)</a> <a href="#ref-for-attribution-cachesâ¢">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-randomized-response">
   <b><a href="#obtain-a-randomized-response">#obtain-a-randomized-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-randomized-response">9.4. Obtaining a random attribution mode</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-source-expiry-time">
   <b><a href="#attribution-source-expiry-time">#attribution-source-expiry-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-source-expiry-time">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-attribution-source-expiry-timeâ ">10.4. Triggering attribution</a>
    <li><a href="#ref-for-attribution-source-expiry-timeâ¡">10.5. Establishing report delivery time</a> <a href="#ref-for-attribution-source-expiry-timeâ¢">(2)</a> <a href="#ref-for-attribution-source-expiry-timeâ£">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-attribution-data">
   <b><a href="#parse-attribution-data">#parse-attribution-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-attribution-data">9.8. Obtaining an attribution source from AttributionSourceParams</a>
    <li><a href="#ref-for-parse-attribution-dataâ ">10.1. Creating an attribution trigger</a> <a href="#ref-for-parse-attribution-dataâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-an-attribution-destination">
   <b><a href="#parse-an-attribution-destination">#parse-an-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-an-attribution-destination">9.8. Obtaining an attribution source from AttributionSourceParams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-random-attribution-mode">
   <b><a href="#obtain-a-random-attribution-mode">#obtain-a-random-attribution-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-random-attribution-mode">9.7. Obtaining an event attribution source from a source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-attribution-source-from-an-anchor">
   <b><a href="#obtain-an-attribution-source-from-an-anchor">#obtain-an-attribution-source-from-an-anchor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-attribution-source-from-an-anchor">2.4. Follow the hyperlink</a>
    <li><a href="#ref-for-obtain-an-attribution-source-from-an-anchorâ ">9.6. Obtaining an event attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-event-attribution-source-from-a-source">
   <b><a href="#obtain-an-event-attribution-source-from-a-source">#obtain-an-event-attribution-source-from-a-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-event-attribution-source-from-a-source">4. Attribution Reporting API</a>
    <li><a href="#ref-for-obtain-an-event-attribution-source-from-a-sourceâ ">9.6. Obtaining an event attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="randomized-event-source-trigger-rate">
   <b><a href="#randomized-event-source-trigger-rate">#randomized-event-source-trigger-rate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-randomized-event-source-trigger-rate">9.7. Obtaining an event attribution source from a source</a> <a href="#ref-for-randomized-event-source-trigger-rateâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-attribution-source-from-params">
   <b><a href="#obtain-an-attribution-source-from-params">#obtain-an-attribution-source-from-params</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-attribution-source-from-params">4. Attribution Reporting API</a>
    <li><a href="#ref-for-obtain-an-attribution-source-from-paramsâ ">9.5. Obtaining an attribution source from an a element</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-event-id-value">
   <b><a href="#max-event-id-value">#max-event-id-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-event-id-value">9.8. Obtaining an attribution source from AttributionSourceParams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="maybe-process-a-navigation-attribution-source">
   <b><a href="#maybe-process-a-navigation-attribution-source">#maybe-process-a-navigation-attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-maybe-process-a-navigation-attribution-source">2.3.4. Document creation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="process-an-attribution-source">
   <b><a href="#process-an-attribution-source">#process-an-attribution-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-an-attribution-source">4. Attribution Reporting API</a> <a href="#ref-for-process-an-attribution-sourceâ ">(2)</a>
    <li><a href="#ref-for-process-an-attribution-sourceâ¡">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-source-cache-size">
   <b><a href="#max-source-cache-size">#max-source-cache-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-source-cache-size">9.9. Processing an attribution source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-an-attribution-trigger">
   <b><a href="#obtain-an-attribution-trigger">#obtain-an-attribution-trigger</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-an-attribution-trigger">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trigger-data-cardinality">
   <b><a href="#trigger-data-cardinality">#trigger-data-cardinality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trigger-data-cardinality">10.1. Creating an attribution trigger</a> <a href="#ref-for-trigger-data-cardinalityâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="event-source-trigger-data-cardinality">
   <b><a href="#event-source-trigger-data-cardinality">#event-source-trigger-data-cardinality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-source-trigger-data-cardinality">9.7. Obtaining an event attribution source from a source</a>
    <li><a href="#ref-for-event-source-trigger-data-cardinalityâ ">10.1. Creating an attribution trigger</a> <a href="#ref-for-event-source-trigger-data-cardinalityâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="should-block-response">
   <b><a href="#should-block-response">#should-block-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-should-block-response">3. Fetch monkeypatches</a>
    <li><a href="#ref-for-should-block-response">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="should-rate-limit-attribution">
   <b><a href="#should-rate-limit-attribution">#should-rate-limit-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-should-rate-limit-attribution">10.3. Should attribution be blocked by rate limit</a>
    <li><a href="#ref-for-should-rate-limit-attribution">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attribution-rate-limit-window">
   <b><a href="#attribution-rate-limit-window">#attribution-rate-limit-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attribution-rate-limit-window">10.3. Should attribution be blocked by rate limit</a> <a href="#ref-for-attribution-rate-limit-windowâ ">(2)</a>
    <li><a href="#ref-for-attribution-rate-limit-windowâ¡">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-attributions-per-rate-limit-window">
   <b><a href="#max-attributions-per-rate-limit-window">#max-attributions-per-rate-limit-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-attributions-per-rate-limit-window">10.3. Should attribution be blocked by rate limit</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trigger-attribution">
   <b><a href="#trigger-attribution">#trigger-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trigger-attribution">10.2. Should internalResponse to request be blocked as attribution trigger</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-reports-per-attribution-destination">
   <b><a href="#max-reports-per-attribution-destination">#max-reports-per-attribution-destination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-reports-per-attribution-destination">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-max-reports-per-attribution-destinationâ ">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-reports-per-source">
   <b><a href="#max-reports-per-source">#max-reports-per-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-reports-per-source">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="max-report-cache-size">
   <b><a href="#max-report-cache-size">#max-report-cache-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-max-report-cache-size">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-max-report-cache-sizeâ ">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-report-delivery-time">
   <b><a href="#obtain-a-report-delivery-time">#obtain-a-report-delivery-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-report-delivery-time">10.6. Obtaining a report</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-a-report">
   <b><a href="#obtain-a-report">#obtain-a-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-a-report">9.9. Processing an attribution source</a>
    <li><a href="#ref-for-obtain-a-reportâ ">10.4. Triggering attribution</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="queue-a-report-for-delivery">
   <b><a href="#queue-a-report-for-delivery">#queue-a-report-for-delivery</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-report-for-delivery">11. Report delivery</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="serialize-an-integer">
   <b><a href="#serialize-an-integer">#serialize-an-integer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serialize-an-integer">11.2. Serialize attribution report body</a> <a href="#ref-for-serialize-an-integerâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="serialize-an-attribution-report">
   <b><a href="#serialize-an-attribution-report">#serialize-an-attribution-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serialize-an-attribution-report">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generate-a-report-url">
   <b><a href="#generate-a-report-url">#generate-a-report-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generate-a-report-url">11.4. Issuing a report request</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attempt-to-deliver-a-report">
   <b><a href="#attempt-to-deliver-a-report">#attempt-to-deliver-a-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attempt-to-deliver-a-report">11. Report delivery</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    {
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|Â )+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>